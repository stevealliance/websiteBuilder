'use strict';
(function(e,t){'object'==typeof exports&&'object'==typeof module?module.exports=t(require('clientnode'),require('ejs'),require('tinymce'),require('tinymce/plugins/anchor'),require('tinymce/plugins/advlist'),require('tinymce/plugins/autoresize'),require('tinymce/plugins/autolink'),require('tinymce/plugins/charmap'),require('tinymce/plugins/code'),require('tinymce/plugins/contextmenu'),require('tinymce/plugins/fullscreen'),require('tinymce/plugins/help'),require('tinymce/plugins/hr'),require('tinymce/plugins/image'),require('tinymce/plugins/imagetools'),require('tinymce/plugins/insertdatetime'),require('tinymce/plugins/lists'),require('tinymce/plugins/link'),require('tinymce/plugins/media'),require('tinymce/plugins/nonbreaking'),require('tinymce/plugins/noneditable'),require('tinymce/plugins/pagebreak'),require('tinymce/plugins/paste'),require('tinymce/plugins/preview'),require('tinymce/plugins/print'),require('tinymce/plugins/searchreplace'),require('tinymce/plugins/spellchecker'),require('tinymce/plugins/table'),require('tinymce/plugins/textcolor'),require('tinymce/plugins/toc'),require('tinymce/plugins/visualblocks'),require('tinymce/plugins/visualchars'),require('tinymce/plugins/wordcount'),require('tinymce/themes/modern/theme')):'function'==typeof define&&define.amd?define('index',['clientnode','ejs','tinymce','tinymce/plugins/anchor','tinymce/plugins/advlist','tinymce/plugins/autoresize','tinymce/plugins/autolink','tinymce/plugins/charmap','tinymce/plugins/code','tinymce/plugins/contextmenu','tinymce/plugins/fullscreen','tinymce/plugins/help','tinymce/plugins/hr','tinymce/plugins/image','tinymce/plugins/imagetools','tinymce/plugins/insertdatetime','tinymce/plugins/lists','tinymce/plugins/link','tinymce/plugins/media','tinymce/plugins/nonbreaking','tinymce/plugins/noneditable','tinymce/plugins/pagebreak','tinymce/plugins/paste','tinymce/plugins/preview','tinymce/plugins/print','tinymce/plugins/searchreplace','tinymce/plugins/spellchecker','tinymce/plugins/table','tinymce/plugins/textcolor','tinymce/plugins/toc','tinymce/plugins/visualblocks','tinymce/plugins/visualchars','tinymce/plugins/wordcount','tinymce/themes/modern/theme'],t):'object'==typeof exports?exports.index=t(require('clientnode'),require('ejs'),require('tinymce'),require('tinymce/plugins/anchor'),require('tinymce/plugins/advlist'),require('tinymce/plugins/autoresize'),require('tinymce/plugins/autolink'),require('tinymce/plugins/charmap'),require('tinymce/plugins/code'),require('tinymce/plugins/contextmenu'),require('tinymce/plugins/fullscreen'),require('tinymce/plugins/help'),require('tinymce/plugins/hr'),require('tinymce/plugins/image'),require('tinymce/plugins/imagetools'),require('tinymce/plugins/insertdatetime'),require('tinymce/plugins/lists'),require('tinymce/plugins/link'),require('tinymce/plugins/media'),require('tinymce/plugins/nonbreaking'),require('tinymce/plugins/noneditable'),require('tinymce/plugins/pagebreak'),require('tinymce/plugins/paste'),require('tinymce/plugins/preview'),require('tinymce/plugins/print'),require('tinymce/plugins/searchreplace'),require('tinymce/plugins/spellchecker'),require('tinymce/plugins/table'),require('tinymce/plugins/textcolor'),require('tinymce/plugins/toc'),require('tinymce/plugins/visualblocks'),require('tinymce/plugins/visualchars'),require('tinymce/plugins/wordcount'),require('tinymce/themes/modern/theme')):e.index=t(e.clientnode,e.ejs,e.tinymce,e['tinymce/plugins/anchor'],e['tinymce/plugins/advlist'],e['tinymce/plugins/autoresize'],e['tinymce/plugins/autolink'],e['tinymce/plugins/charmap'],e['tinymce/plugins/code'],e['tinymce/plugins/contextmenu'],e['tinymce/plugins/fullscreen'],e['tinymce/plugins/help'],e['tinymce/plugins/hr'],e['tinymce/plugins/image'],e['tinymce/plugins/imagetools'],e['tinymce/plugins/insertdatetime'],e['tinymce/plugins/lists'],e['tinymce/plugins/link'],e['tinymce/plugins/media'],e['tinymce/plugins/nonbreaking'],e['tinymce/plugins/noneditable'],e['tinymce/plugins/pagebreak'],e['tinymce/plugins/paste'],e['tinymce/plugins/preview'],e['tinymce/plugins/print'],e['tinymce/plugins/searchreplace'],e['tinymce/plugins/spellchecker'],e['tinymce/plugins/table'],e['tinymce/plugins/textcolor'],e['tinymce/plugins/toc'],e['tinymce/plugins/visualblocks'],e['tinymce/plugins/visualchars'],e['tinymce/plugins/wordcount'],e['tinymce/themes/modern/theme'])})('undefined'==typeof self?this:self,function(e,t,o,r,i,n,a,s,l,d,p,c,u,m,h,g,y,_,b,f,v,w,x,C,k,E,N,j,T,A,S,I,O,P){return function(e){function t(r){if(o[r])return o[r].exports;var i=o[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var o={};return t.m=e,t.c=o,t.d=function(e,o,r){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var o=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(o,'a',o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s=14)}([function(e,t,o){e.exports=o.p+'editorAssets.compiled/skins/lightgray/fonts/tinymce.eot'},function(e,t,o){e.exports=o.p+'editorAssets.compiled/skins/lightgray/fonts/tinymce-small.eot'},function(e){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],!e.children&&(e.children=[]),Object.defineProperty(e,'loaded',{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,'id',{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(t){t.exports=e},function(e,t,o){e.exports=o.p+'editorAssets.compiled/skins/lightgray/content.inline.min.css'},function(e,t,o){e.exports=o.p+'editorAssets.compiled/skins/lightgray/content.min.css'},function(e,t,o){e.exports=o.p+'editorAssets.compiled/skins/lightgray/content.mobile.min.css'},function(e,t,o){e.exports=o.p+'editorAssets.compiled/skins/lightgray/fonts/tinymce-mobile.woff'},function(e,t,o){e.exports=o.p+'editorAssets.compiled/skins/lightgray/img/anchor.gif'},function(e,t,o){e.exports=o.p+'editorAssets.compiled/skins/lightgray/img/loader.gif'},function(e,t,o){e.exports=o.p+'editorAssets.compiled/skins/lightgray/img/object.gif'},function(e,t,o){e.exports=o.p+'editorAssets.compiled/skins/lightgray/img/trans.gif'},function(e,t,o){e.exports=o.p+'editorAssets.compiled/skins/lightgray/skin.min.css'},function(e,t,o){e.exports=o.p+'editorAssets.compiled/skins/lightgray/skin.mobile.min.css'},function(e,t,o){e.exports=o(15)},function(e,t,o){'use strict';(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')}function n(e,t){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return t&&('object'==typeof t||'function'==typeof t)?t:e}function s(e,t){if('function'!=typeof t&&null!==t)throw new TypeError('Super expression must either be null or a function, not '+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a,l,d=o(3),p=o(16),c=r(p),u=o(17),y=r(u),m=o(18),h=r(m);t.__esModule=!0,t.WebsiteBuilder=t.$=void 0,o(19),o(20),o(21),o(22),o(23),o(24),o(25),o(26),o(27),o(28),o(29),o(30),o(31),o(32),o(33),o(34),o(35),o(36),o(37),o(38),o(39),o(40),o(41),o(42),o(43),o(44),o(45),o(46),o(47),o(48),o(49),o(50);try{e.require('source-map-support/register')}catch(e){}o(51);var _=t.$=d.$,g=t.WebsiteBuilder=(l=a=function(t){function o(){var r,a,s;i(this,o);for(var e=arguments.length,l=Array(e),d=0;d<e;d++)l[d]=arguments[d];return s=(r=(a=n(this,t.call.apply(t,[this].concat(l))),a),a.currentMode='hybrid',a.domNodes={},a.domNode=a.domNode,a.inPlaceEditorInstances=a.inPlaceEditorInstances,a.initialized=!1,a.initialScope={},a.scope={},a.jsonEditor=a.jsonEditor,a.onChangeListener=[],a.template='',a.scope={},r),n(a,s)}return s(o,t),o.unescapeHTML=function(e){return e.replace(new RegExp(Object.keys(o.escapedMarkupSymbolMapping).join('|'),'g'),function(e){return o.escapedMarkupSymbolMapping[e]})},o.prototype.initialize=function(){var o=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this._options={className:{selectedEditorIndicator:'selected',synchronizedEditorTemplateValue:'synchronized'},defaultParameterScope:{},entryPointAttributeName:'root',inPlaceEditor:{default:{allow_conditional_comments:!1,allow_script_urls:!1,cache_suffix:'?version=1513359962.744',convert_fonts_to_spans:!0,document_base_url:'/',element_format:'xhtml',entity_encoding:'raw',fix_list_elements:!0,forced_root_block:null,hidden_input:!1,inline:!0,invalid_elements:'em',invalid_styles:'color font-size line-height',keep_styles:!1,menubar:!1,plugins:'fullscreen link code hr nonbreaking searchreplace visualblocks',relative_urls:!1,remove_script_host:!1,remove_trailing_brs:!0,schema:'html5',skin_url:'editorAssets.compiled/skins/lightgray',toolbar1:'cut copy paste | undo redo removeformat | styleselect formatselect fontselect fontsizeselect | searchreplace visualblocks fullscreen code',toolbar2:'alignleft aligncenter alignright alignjustify outdent indent | link hr nonbreaking bullist numlist bold italic underline strikethrough',trim:!0},raw:{toolbar1:'cut copy paste | undo redo removeformat | code | fullscreen',toolbar2:!1},simple:{toolbar1:'cut copy paste | undo redo removeformat | bold italic underline strikethrough subscript superscript | fullscreen',toolbar2:!1},normal:{toolbar1:'cut copy paste | undo redo removeformat | styleselect formatselect | searchreplace visualblocks fullscreen code'},advanced:{}},jsonEditor:{disable_array_delete_all_rows:!0,disable_array_delete_last_row:!0,disable_collapse:!0,disable_edit_json:!0,disable_properties:!0,format:'grid'},neededDomNodeSpecifications:{buttons:[{action:function(e){o.domNodes.jsonEditor.style.display='active'===e?'block':'none'},label:{active:'Hide options',inactive:'Show options'},name:'options',states:['inactive','active']},{action:this.updateMode.bind(this),label:{hybrid:'Show preview',preview:'Mark editables',helper:'Unmark editables'},name:'preview',states:['hybrid','preview','helper']},{action:function(){console.log('TODO synchronize all')},label:{dirty:'Synchronize all',synchronized:''},name:'synchronizeAll',states:['synchronized','dirty']},{action:function(){console.log('TODO synchronize current')},label:{dirty:'Synchronize',synchronized:''},name:'synchronizeSelected',states:['synchronized','dirty']},{action:function(){console.log('TODO clear all')},label:{cleared:'',filled:'clear'},name:'clear',states:['filled','cleared']},{action:function(){console.log('TODO reset all')},label:{changed:'reset',unchanged:''},name:'reset',states:['unchanged','change']},{action:function(t){for(var r=o.domNodes.toolbar.querySelectorAll('button'),i=Array.isArray(r),n=0,e=i?r:r[Symbol.iterator]();;){var a;if(i){if(n>=r.length)break;a=r[n++]}else{if(n=r.next(),n.done)break;a=n.value}var s=a;s!==o.domNodes.toggleToolbar&&(s.style.display='show'===t?'none':'initial')}},label:{hide:'Show toolbar',show:'Hide toolbar'},name:'toggleToolbar',states:['hide','show']}],divs:[{name:'jsonEditor',style:{backgroundColor:'white',display:'none',position:'absolute',letf:0,top:0,width:'100%',zIndex:387420489}},{name:'toolbar',style:{backgroundColor:'white',position:'absolute',right:0,top:0,zIndex:387420490}}]},retrieveContent:{},schema:null,schemaName:'schema',scope:null,scopeName:'scope',waitForDocumentReady:!0},t.prototype.initialize.call(this,e),this._options.schema||(this._options.schema=this.constructor.schema),this._options.schema||(this._options.schema=_.global[this._options.schemaName]||{}),this._options.scope||(this._options.scope=this.constructor.scope),this._options.scope||(this._options.scope=_.global[this._options.scopeName]||{}),this.scope=this._options.scope,new Promise(function(e){o._options.waitForDocumentReady?_.global.document.addEventListener('DOMContentLoaded',function(){return e(o.bootstrap())}):e(o.bootstrap())})},o.prototype.bootstrap=function(){var t=this;this.domNode=_.global.document.querySelector('['+this._options.entryPointAttributeName+']'),this.domNode||(this.domNode=_.global.document.createElement('div'),this.domNode.setAttribute(this._options.entryPointAttributeName,''),this.domNode.innerHTML=_.global.document.body.innerHTML,_.global.document.body.innerHTML='',_.global.document.body.appendChild(this.domNode)),this.template=this.domNode.innerHTML;for(var o=this._options.neededDomNodeSpecifications.divs,r=Array.isArray(o),a=0,s=r?o:o[Symbol.iterator]();;){var d;if(r){if(a>=o.length)break;d=o[a++]}else{if(a=o.next(),a.done)break;d=a.value}var e=d,p=_.global.document.createElement('div');for(var l in e.style)e.style.hasOwnProperty(l)&&(p.style[l]=e.style[l]);this.domNodes[e.name]=p,_.global.document.body.appendChild(p)}for(var c=function(e){e.state=e.states[0];var o=_.global.document.createElement('button');o.addEventListener('click',function(){e.state=e.states[(e.states.indexOf(e.state)+1)%e.states.length],o.textContent=e.label[e.state],e.action(e.state)}),o.textContent=e.label[e.state],t.domNodes[e.name]=o,t.domNodes.toolbar.appendChild(o)},u=this._options.neededDomNodeSpecifications.buttons,m=Array.isArray(u),h=0,i=m?u:u[Symbol.iterator]();;){var g;if(m){if(h>=u.length)break;g=u[h++]}else{if(h=u.next(),h.done)break;g=h.value}var b=g;c(b)}return this.jsonEditor=new y.default(this.domNodes.jsonEditor,this.constructor.extendObject(this._options.jsonEditor,{schema:this._options.schema})),this.jsonEditor.setValue(this.scope.parameter),this.jsonEditor.on('change',function(){t.initialized=!0;var e=t.jsonEditor.validate();e.length?_.global.alert(e[0]):(t.constructor.extendObject(!0,t.scope.parameter,t.jsonEditor.getValue()),t.updateMode())}),this},o.prototype.initializeDomNode=function(e,t,o){'preview'===this.currentMode?this.renderDomNode(e.toLowerCase().includes('initialized'),t,o):this.initializeInPlaceEditor(e,t,o)},o.prototype.initializeDomNodes=function(){this.inPlaceEditorInstances={};for(var t=o.attributeNames,r=Array.isArray(t),n=0,a=r?t:t[Symbol.iterator]();;){var s;if(r){if(n>=t.length)break;s=t[n++]}else{if(n=t.next(),n.done)break;s=n.value}for(var e=s,d=this.domNode.querySelectorAll('['+e+']'),p=Array.isArray(d),c=0,i=p?d:d[Symbol.iterator]();;){var u;if(p){if(c>=d.length)break;u=d[c++]}else{if(c=d.next(),c.done)break;u=c.value}var m=u,h=m.getAttribute(e);h&&this.initializeDomNode(e,h,m)}}},o.prototype.initializeInPlaceEditor=function(t,o,r){var i=this,n=[r];this.registerInPlaceEditor(o,n),t.toLowerCase().includes('initialized')||(r.innerHTML='');var e='normal';t.toLowerCase().includes('advanced')?e='advanced':t.toLowerCase().includes('simple')?e='simple':t.toLowerCase().includes('raw')&&(e='raw'),r.addEventListener('click',function(){return h.default.init(i.constructor.extendObject(!0,{},i._options.inPlaceEditor.default,i._options.inPlaceEditor[e],{setup:function(e){n.push(e),e.on('init',function(){e.focus(),i._inPlaceEditorBackgroundColorFix()}),e.on('focus',function(){var e=i._options.className.selectedEditorIndicator,t=i.domNode.querySelector('.'+e);t&&t.classList.remove(e),r.classList.add(e)}),e.on('blur',r.blur.bind(r)),e.on('ExecCommand',function(){return i.updateModel(o,e)});for(var t,a=['change','ObjectResized'],s=0;s<a.length;s++)t=a[s],e.on(t,function(){e.save(),i.updateModel(o,e)})},target:r}))}),this.updateModel(o,r,!0)},o.prototype.populateData=function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:!0,o=this.onChangeListener,r=Array.isArray(o),i=0,n=r?o:o[Symbol.iterator]();;){var a;if(r){if(i>=o.length)break;a=o[i++]}else{if(i=o.next(),i.done)break;a=i.value}var e=a;e(t,this.currentMode,this.options,this.domNode)}console.log('TODO Send data: ',this.scope)},o.prototype.registerInPlaceEditor=function(e,t){this.inPlaceEditorInstances.hasOwnProperty(e)?this.inPlaceEditorInstances[e].push(t):this.inPlaceEditorInstances[e]=[t]},o.prototype.registerOnChange=function(e){var t=this;return this.onChangeListener.push(e),this.initialized&&e(!0,this.currentMode,this.options,this.domNode),function(){var o=t.onChangeListener.indexOf(e);-1!==o&&t.onChangeListener.splice(o,1)}},o.prototype.render=function(e){var t=this;if(e){var o=Object.keys(this.scope).filter(function(e){try{new Function('var '+e)()}catch(e){return!1}return!0});return new(Function.prototype.bind.apply(Function,[null].concat(['scope'],o,['return `'+e+'`'])))().apply(void 0,[this.scope].concat(o.map(function(e){return t.scope[e]})))}return''},o.prototype.renderDomNode=function(e,t,o){var r='';this.scope.hasOwnProperty(t)?r=this.scope[t]:e&&(r=o.innerHTML.trim()),o.innerHTML=this.render(r)},o.prototype.renderParameter=function(){return this.domNode.innerHTML=c.default.render(o.unescapeHTML(this.template),this.constructor.extendObject(!0,{Tools:this.constructor},this._options.defaultParameterScope,this.scope.parameter)).trim()},o.prototype.transformContent=function(e){return e.trim()},o.prototype.updateMode=function(e){e&&(this.currentMode=e);for(var t,o=['preview','hybrid','helper'],r=0;r<o.length;r++)t=o[r],this.domNode.classList.remove(t);this.domNode.classList.add(this.currentMode),this.renderParameter(),this.initializeDomNodes(),this.populateData()},o.prototype.updateModel=function(t,o){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=this.transformContent('getContent'in o?o.getContent():o.innerHTML);r&&(this.initialScope[t]=n,t in this.scope&&(n=this.scope[t]));var a=!1;this.constructor.isEquivalentDOM(this.initialScope[t],n)?(t in this.scope&&delete this.scope[t],a=!0):this.scope[t]=n;for(var e=this.inPlaceEditorInstances[t],s=Array.isArray(e),l=0,d=s?e:e[Symbol.iterator]();;){var p;if(s){if(l>=e.length)break;p=e[l++]}else{if(l=e.next(),l.done)break;p=l.value}var i=p;2===i.length?i[1].getDoc()&&i[1].getContent()!==n&&i[1].setContent(n):i[0].innerHTML!==n&&(i[0].innerHTML=n),i[0].setAttribute('title',t),a&&i.includes(o)?i[0].classList.add(this._options.className.synchronizedEditorTemplateValue):i[0].classList.remove(this._options.className.synchronizedEditorTemplateValue)}this.populateData(!1)},o.prototype._inPlaceEditorBackgroundColorFix=function(){for(var e,t=this,o=['click','mouseover'],r=0;r<o.length;r++)e=o[r],_.global.document.body.addEventListener(e,function(o){if(o.target&&(o.target.classList.contains('mce-tinymce-inline')||o.target.classList.contains('mce-container'))){var r=t.domNode.querySelector('.mce-tinymce-inline'),n=r?r.querySelectorAll('button'):[],a=t.domNode.querySelector('.mce-container'),i=a?a.querySelectorAll('span[style]:not([contenteditable])'):[];if(n.length&&i.length)for(var s=i,l=Array.isArray(s),d=0,e=l?s:s[Symbol.iterator]();;){var p;if(l){if(d>=s.length)break;p=s[d++]}else{if(d=s.next(),d.done)break;p=d.value}var c=p;c.style.color=n[0].style.color}}})},o}(_.Tools.class),a.attributeNames=['rawEditable','rawInitializedEditable','simpleEditable','simpleInitializedEditable','editable','initializedEditable','advancedEditable','advancedInitializedEditable'],a.escapedMarkupSymbolMapping={"&amp;":'&',"&lt;":'<',"&gt;":'>',"&quot;":'"',"&#039;":'\''},l);t.default=g,_.WebsiteBuilder=function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return _.Tools().controller(g,t)}}).call(t,o(2)(e))},function(e){e.exports=t},function(e){(function(){var e,t=Math.min,o=Math.ceil,r=Math.floor,n=Math.max;(function(){var t=!1,o=/xyz/.test(function(){window.postMessage('xyz')})?/\b_super\b/:/.*/;return e=function(){},e.extend=function e(r){function i(){!t&&this.init&&this.init.apply(this,arguments)}var n=this.prototype;t=!0;var a=new this;for(var s in t=!1,r)a[s]='function'==typeof r[s]&&'function'==typeof n[s]&&o.test(r[s])?function(e,t){return function(){var o=this._super;this._super=n[e];var r=t.apply(this,arguments);return this._super=o,r}}(s,r[s]):r[s];return i.prototype=a,i.prototype.constructor=i,i.extend=e,i},e})(),function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var o=document.createEvent('CustomEvent');return o.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),o}e.prototype=window.Event.prototype,window.CustomEvent=e}(),function(){for(var e=0,t=['ms','moz','webkit','o'],o=0;o<t.length&&!window.requestAnimationFrame;++o)window.requestAnimationFrame=window[t[o]+'RequestAnimationFrame'],window.cancelAnimationFrame=window[t[o]+'CancelAnimationFrame']||window[t[o]+'CancelRequestAnimationFrame'];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var o=new Date().getTime(),r=n(0,16-(o-e)),i=window.setTimeout(function(){t(o+r)},r);return e=o+r,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),function(){Array.isArray||(Array.isArray=function(e){return'[object Array]'===Object.prototype.toString.call(e)})}();var a=function(e){return'object'!=typeof e||e.nodeType||null!==e&&e===e.window?!1:e.constructor&&!Object.prototype.hasOwnProperty.call(e.constructor.prototype,'isPrototypeOf')?!1:!0},s=function(e){var t,o,r;for(o=1;o<arguments.length;o++)for(r in t=arguments[o],t)t.hasOwnProperty(r)&&(t[r]&&a(t[r])?(!e.hasOwnProperty(r)&&(e[r]={}),s(e[r],t[r])):e[r]=t[r]);return e},l=function(e,t){if(e&&'object'==typeof e){if(Array.isArray(e)||'number'==typeof e.length&&0<e.length&&e.length-1 in e){for(r=0;r<e.length;r++)if(!1===t(r,e[r]))return;}else if(Object.keys){var o=Object.keys(e);for(r=0;r<o.length;r++)if(!1===t(o[r],e[o[r]]))return}else for(var r in e)if(e.hasOwnProperty(r)&&!1===t(r,e[r]))return}},i=function(t,o){var r=document.createEvent('HTMLEvents');r.initEvent(o,!0,!0),t.dispatchEvent(r)},d=function(e,t){if(!(e instanceof Element))throw new Error('element should be an instance of Element');t=s({},d.defaults.options,t||{}),this.element=e,this.options=t,this.init()};d.prototype={constructor:d,init:function(){var e=this;this.ready=!1;var t=d.defaults.themes[this.options.theme||d.defaults.theme];if(!t)throw'Unknown theme '+(this.options.theme||d.defaults.theme);this.schema=this.options.schema,this.theme=new t,this.template=this.options.template,this.refs=this.options.refs||{},this.uuid=0,this.__data={};var o=d.defaults.iconlibs[this.options.iconlib||d.defaults.iconlib];o&&(this.iconlib=new o),this.root_container=this.theme.getContainer(),this.element.appendChild(this.root_container),this.translate=this.options.translate||d.defaults.translate,this._loadExternalRefs(this.schema,function(){e._getDefinitions(e.schema);var t={};e.options.custom_validators&&(t.custom_validators=e.options.custom_validators),e.validator=new d.Validator(e,null,t);var o=e.getEditorClass(e.schema);e.root=e.createEditor(o,{jsoneditor:e,schema:e.schema,required:!0,container:e.root_container}),e.root.preBuild(),e.root.build(),e.root.postBuild(),e.options.startval&&e.root.setValue(e.options.startval),e.validation_results=e.validator.validate(e.root.getValue()),e.root.showValidationErrors(e.validation_results),e.ready=!0,window.requestAnimationFrame(function(){e.ready&&(e.validation_results=e.validator.validate(e.root.getValue()),e.root.showValidationErrors(e.validation_results),e.trigger('ready'),e.trigger('change'))})})},getValue:function(){if(!this.ready)throw'JSON Editor not ready yet.  Listen for \'ready\' event before getting the value';return this.root.getValue()},setValue:function(e){if(!this.ready)throw'JSON Editor not ready yet.  Listen for \'ready\' event before setting the value';return this.root.setValue(e),this},validate:function(e){if(!this.ready)throw'JSON Editor not ready yet.  Listen for \'ready\' event before validating';return 1===arguments.length?this.validator.validate(e):this.validation_results},destroy:function(){this.destroyed||!this.ready||(this.schema=null,this.options=null,this.root.destroy(),this.root=null,this.root_container=null,this.validator=null,this.validation_results=null,this.theme=null,this.iconlib=null,this.template=null,this.__data=null,this.ready=!1,this.element.innerHTML='',this.destroyed=!0)},on:function(e,t){return this.callbacks=this.callbacks||{},this.callbacks[e]=this.callbacks[e]||[],this.callbacks[e].push(t),this},off:function(e,t){if(e&&t){this.callbacks=this.callbacks||{},this.callbacks[e]=this.callbacks[e]||[];for(var o=[],r=0;r<this.callbacks[e].length;r++)this.callbacks[e][r]!==t&&o.push(this.callbacks[e][r]);this.callbacks[e]=o}else e?(this.callbacks=this.callbacks||{},this.callbacks[e]=[]):this.callbacks={};return this},trigger:function(e){if(this.callbacks&&this.callbacks[e]&&this.callbacks[e].length)for(var t=0;t<this.callbacks[e].length;t++)this.callbacks[e][t]();return this},setOption:function(e,t){if('show_errors'===e)this.options.show_errors=t,this.onChange();else throw'Option '+e+' must be set during instantiation and cannot be changed later';return this},getEditorClass:function(e){var t;if(e=this.expandSchema(e),l(d.defaults.resolvers,function(o,r){var i=r(e);if(i&&d.defaults.editors[i])return t=i,!1}),!t)throw'Unknown editor for schema '+JSON.stringify(e);if(!d.defaults.editors[t])throw'Unknown editor '+t;return d.defaults.editors[t]},createEditor:function(e,t){return t=s({},e.options||{},t),new e(t)},onChange:function(){if(this.ready&&!this.firing_change){this.firing_change=!0;var e=this;return window.requestAnimationFrame(function(){e.firing_change=!1,e.ready&&(e.validation_results=e.validator.validate(e.root.getValue()),'never'===e.options.show_errors?e.root.showValidationErrors([]):e.root.showValidationErrors(e.validation_results),e.trigger('change'))}),this}},compileTemplate:function(e,t){t=t||d.defaults.template;var o;if('string'==typeof t){if(!d.defaults.templates[t])throw'Unknown template engine '+t;if(o=d.defaults.templates[t](),!o)throw'Template engine '+t+' missing required library.'}else o=t;if(!o)throw'No template engine set';if(!o.compile)throw'Invalid template engine set';return o.compile(e)},_data:function(e,t,o){if(3===arguments.length){var r;e.hasAttribute('data-jsoneditor-'+t)?r=e.getAttribute('data-jsoneditor-'+t):(r=this.uuid++,e.setAttribute('data-jsoneditor-'+t,r)),this.__data[r]=o}else return e.hasAttribute('data-jsoneditor-'+t)?this.__data[e.getAttribute('data-jsoneditor-'+t)]:null},registerEditor:function(e){return this.editors=this.editors||{},this.editors[e.path]=e,this},unregisterEditor:function(e){return this.editors=this.editors||{},this.editors[e.path]=null,this},getEditor:function(e){return this.editors?this.editors[e]:void 0},watch:function(e,t){return this.watchlist=this.watchlist||{},this.watchlist[e]=this.watchlist[e]||[],this.watchlist[e].push(t),this},unwatch:function(e,t){if(!this.watchlist||!this.watchlist[e])return this;if(!t)return this.watchlist[e]=null,this;for(var o=[],r=0;r<this.watchlist[e].length;r++)if(this.watchlist[e][r]===t)continue;else o.push(this.watchlist[e][r]);return this.watchlist[e]=o.length?o:null,this},notifyWatchers:function(e){if(!this.watchlist||!this.watchlist[e])return this;for(var t=0;t<this.watchlist[e].length;t++)this.watchlist[e][t]()},isEnabled:function(){return!this.root||this.root.isEnabled()},enable:function(){this.root.enable()},disable:function(){this.root.disable()},_getDefinitions:function(e,t){if(t=t||'#/definitions/',e.definitions)for(var o in e.definitions)e.definitions.hasOwnProperty(o)&&(this.refs[t+o]=e.definitions[o],e.definitions[o].definitions&&this._getDefinitions(e.definitions[o],t+o+'/definitions/'))},_getExternalRefs:function(e){var t={},o=function(e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=!0)};for(var r in e.$ref&&'object'!=typeof e.$ref&&'#'!==e.$ref.substr(0,1)&&!this.refs[e.$ref]&&(t[e.$ref]=!0),e)if(e.hasOwnProperty(r))if(e[r]&&'object'==typeof e[r]&&Array.isArray(e[r]))for(var i=0;i<e[r].length;i++)'object'==typeof e[r][i]&&o(this._getExternalRefs(e[r][i]));else e[r]&&'object'==typeof e[r]&&o(this._getExternalRefs(e[r]));return t},_loadExternalRefs:function(e,t){var o=this,r=this._getExternalRefs(e),i=0,n=0,a=!1;l(r,function(s){if(!o.refs[s]){if(!o.options.ajax)throw'Must set ajax option to true to load external ref '+s;o.refs[s]='loading',n++;var e=new XMLHttpRequest;e.open('GET',s,!0),e.onreadystatechange=function(){if(4==e.readyState)if(200===e.status){var r;try{r=JSON.parse(e.responseText)}catch(t){throw window.console.log(t),'Failed to parse external ref '+s}if(!r||'object'!=typeof r)throw'External ref does not contain a valid schema - '+s;o.refs[s]=r,o._loadExternalRefs(r,function(){i++,i>=n&&!a&&(a=!0,t())})}else throw window.console.log(e),'Failed to fetch ref via ajax- '+s},e.send()}}),n||t()},expandRefs:function(e){for(e=s({},e);e.$ref;){var t=e.$ref;delete e.$ref,this.refs[t]||(t=decodeURIComponent(t)),e=this.extendSchemas(e,this.refs[t])}return e},expandSchema:function(e){var t,o=this,r=s({},e);if('object'==typeof e.type&&(Array.isArray(e.type)?l(e.type,function(t,r){'object'==typeof r&&(e.type[t]=o.expandSchema(r))}):e.type=o.expandSchema(e.type)),'object'==typeof e.disallow&&(Array.isArray(e.disallow)?l(e.disallow,function(t,r){'object'==typeof r&&(e.disallow[t]=o.expandSchema(r))}):e.disallow=o.expandSchema(e.disallow)),e.anyOf&&l(e.anyOf,function(t,r){e.anyOf[t]=o.expandSchema(r)}),e.dependencies&&l(e.dependencies,function(t,r){'object'!=typeof r||Array.isArray(r)||(e.dependencies[t]=o.expandSchema(r))}),e.not&&(e.not=this.expandSchema(e.not)),e.allOf){for(t=0;t<e.allOf.length;t++)r=this.extendSchemas(r,this.expandSchema(e.allOf[t]));delete r.allOf}if(e['extends']){if(!Array.isArray(e['extends']))r=this.extendSchemas(r,this.expandSchema(e['extends']));else for(t=0;t<e['extends'].length;t++)r=this.extendSchemas(r,this.expandSchema(e['extends'][t]));delete r['extends']}if(e.oneOf){var i=s({},r);for(delete i.oneOf,t=0;t<e.oneOf.length;t++)r.oneOf[t]=this.extendSchemas(this.expandSchema(e.oneOf[t]),i)}return this.expandRefs(r)},extendSchemas:function(e,t){e=s({},e),t=s({},t);var o=this,r={};return l(e,function(e,i){'undefined'==typeof t[e]?r[e]=i:('required'===e||'defaultProperties'===e)&&'object'==typeof i&&Array.isArray(i)?r[e]=i.concat(t[e]).reduce(function(e,t){return 0>e.indexOf(t)&&e.push(t),e},[]):'type'===e&&('string'==typeof i||Array.isArray(i))?('string'==typeof i&&(i=[i]),'string'==typeof t.type&&(t.type=[t.type]),r.type=t.type&&t.type.length?i.filter(function(e){return-1!==t.type.indexOf(e)}):i,1===r.type.length&&'string'==typeof r.type[0]?r.type=r.type[0]:0===r.type.length&&delete r.type):'object'==typeof i&&Array.isArray(i)?r[e]=i.filter(function(o){return-1!==t[e].indexOf(o)}):'object'==typeof i&&null!==i?r[e]=o.extendSchemas(i,t[e]):r[e]=i}),l(t,function(t,o){'undefined'==typeof e[t]&&(r[t]=o)}),r}},d.defaults={themes:{},templates:{},iconlibs:{},editors:{},languages:{},resolvers:[],custom_validators:[]},d.Validator=e.extend({init:function(e,t,o){this.jsoneditor=e,this.schema=t||this.jsoneditor.schema,this.options=o||{},this.translate=this.jsoneditor.translate||d.defaults.translate},validate:function(e){return this._validateSchema(this.schema,e)},_validateSchema:function(e,t,o){var n,a,i,p=this,c=[],u=JSON.stringify(t);if(o=o||'root',e=s({},this.jsoneditor.expandRefs(e)),e.required&&!0===e.required){if('undefined'==typeof t)return c.push({path:o,property:'required',message:this.translate('error_notset')}),c;}else if('undefined'==typeof t)if(this.jsoneditor.options.required_by_default)c.push({path:o,property:'required',message:this.translate('error_notset')});else return c;if(e['enum']){for(n=!1,a=0;a<e['enum'].length;a++)u===JSON.stringify(e['enum'][a])&&(n=!0);n||c.push({path:o,property:'enum',message:this.translate('error_enum')})}if(e['extends'])for(a=0;a<e['extends'].length;a++)c=c.concat(this._validateSchema(e['extends'][a],t,o));if(e.allOf)for(a=0;a<e.allOf.length;a++)c=c.concat(this._validateSchema(e.allOf[a],t,o));if(e.anyOf){for(n=!1,a=0;a<e.anyOf.length;a++)if(!this._validateSchema(e.anyOf[a],t,o).length){n=!0;break}n||c.push({path:o,property:'anyOf',message:this.translate('error_anyOf')})}if(e.oneOf){n=0;var m=[];for(a=0;a<e.oneOf.length;a++){var h=this._validateSchema(e.oneOf[a],t,o);for(h.length||n++,i=0;i<h.length;i++)h[i].path=o+'.oneOf['+a+']'+h[i].path.substr(o.length);m=m.concat(h)}1!==n&&(c.push({path:o,property:'oneOf',message:this.translate('error_oneOf',[n])}),c=c.concat(m))}if(e.not&&!this._validateSchema(e.not,t,o).length&&c.push({path:o,property:'not',message:this.translate('error_not')}),e.type)if(Array.isArray(e.type)){for(n=!1,a=0;a<e.type.length;a++)if(this._checkType(e.type[a],t)){n=!0;break}n||c.push({path:o,property:'type',message:this.translate('error_type_union')})}else this._checkType(e.type,t)||c.push({path:o,property:'type',message:this.translate('error_type',[e.type])});if(e.disallow)if(Array.isArray(e.disallow)){for(n=!0,a=0;a<e.disallow.length;a++)if(this._checkType(e.disallow[a],t)){n=!1;break}n||c.push({path:o,property:'disallow',message:this.translate('error_disallow_union')})}else this._checkType(e.disallow,t)&&c.push({path:o,property:'disallow',message:this.translate('error_disallow',[e.disallow])});if('number'==typeof t){if(e.multipleOf||e.divisibleBy){var g=e.multipleOf||e.divisibleBy;n=t/g===r(t/g),window.math?n=window.math.mod(window.math.bignumber(t),window.math.bignumber(g)).equals(0):window.Decimal&&(n=new window.Decimal(t).mod(new window.Decimal(g)).equals(0)),n||c.push({path:o,property:e.multipleOf?'multipleOf':'divisibleBy',message:this.translate('error_multipleOf',[g])})}e.hasOwnProperty('maximum')&&(n=e.exclusiveMaximum?t<e.maximum:t<=e.maximum,window.math?n=window.math[e.exclusiveMaximum?'smaller':'smallerEq'](window.math.bignumber(t),window.math.bignumber(e.maximum)):window.Decimal&&(n=new window.Decimal(t)[e.exclusiveMaximum?'lt':'lte'](new window.Decimal(e.maximum))),!n&&c.push({path:o,property:'maximum',message:this.translate(e.exclusiveMaximum?'error_maximum_excl':'error_maximum_incl',[e.maximum])})),e.hasOwnProperty('minimum')&&(n=e.exclusiveMinimum?t>e.minimum:t>=e.minimum,window.math?n=window.math[e.exclusiveMinimum?'larger':'largerEq'](window.math.bignumber(t),window.math.bignumber(e.minimum)):window.Decimal&&(n=new window.Decimal(t)[e.exclusiveMinimum?'gt':'gte'](new window.Decimal(e.minimum))),!n&&c.push({path:o,property:'minimum',message:this.translate(e.exclusiveMinimum?'error_minimum_excl':'error_minimum_incl',[e.minimum])}))}else if('string'==typeof t)e.maxLength&&(t+'').length>e.maxLength&&c.push({path:o,property:'maxLength',message:this.translate('error_maxLength',[e.maxLength])}),e.minLength&&(t+'').length<e.minLength&&c.push({path:o,property:'minLength',message:this.translate(1===e.minLength?'error_notempty':'error_minLength',[e.minLength])}),e.pattern&&!new RegExp(e.pattern).test(t)&&c.push({path:o,property:'pattern',message:this.translate('error_pattern',[e.pattern])});else if('object'==typeof t&&null!==t&&Array.isArray(t)){if(e.items)if(Array.isArray(e.items)){for(a=0;a<t.length;a++)if(e.items[a])c=c.concat(this._validateSchema(e.items[a],t[a],o+'.'+a));else if(!0===e.additionalItems)break;else if(e.additionalItems)c=c.concat(this._validateSchema(e.additionalItems,t[a],o+'.'+a));else if(!1===e.additionalItems){c.push({path:o,property:'additionalItems',message:this.translate('error_additionalItems')});break}else break;}else for(a=0;a<t.length;a++)c=c.concat(this._validateSchema(e.items,t[a],o+'.'+a));if(e.maxItems&&t.length>e.maxItems&&c.push({path:o,property:'maxItems',message:this.translate('error_maxItems',[e.maxItems])}),e.minItems&&t.length<e.minItems&&c.push({path:o,property:'minItems',message:this.translate('error_minItems',[e.minItems])}),e.uniqueItems){var y={};for(a=0;a<t.length;a++){if(n=JSON.stringify(t[a]),y[n]){c.push({path:o,property:'uniqueItems',message:this.translate('error_uniqueItems')});break}y[n]=!0}}}else if('object'==typeof t&&null!==t){if(e.maxProperties){for(a in n=0,t)t.hasOwnProperty(a)&&n++;n>e.maxProperties&&c.push({path:o,property:'maxProperties',message:this.translate('error_maxProperties',[e.maxProperties])})}if(e.minProperties){for(a in n=0,t)t.hasOwnProperty(a)&&n++;n<e.minProperties&&c.push({path:o,property:'minProperties',message:this.translate('error_minProperties',[e.minProperties])})}if(e.required&&Array.isArray(e.required))for(a=0;a<e.required.length;a++)'undefined'==typeof t[e.required[a]]&&c.push({path:o,property:'required',message:this.translate('error_required',[e.required[a]])});var _={};if(e.properties)for(a in e.properties)e.properties.hasOwnProperty(a)&&(_[a]=!0,c=c.concat(this._validateSchema(e.properties[a],t[a],o+'.'+a)));if(e.patternProperties)for(a in e.patternProperties)if(e.patternProperties.hasOwnProperty(a)){var b=new RegExp(a);for(i in t)t.hasOwnProperty(i)&&b.test(i)&&(_[i]=!0,c=c.concat(this._validateSchema(e.patternProperties[a],t[i],o+'.'+i)))}if('undefined'!=typeof e.additionalProperties||!this.jsoneditor.options.no_additional_properties||e.oneOf||e.anyOf||(e.additionalProperties=!1),'undefined'!=typeof e.additionalProperties)for(a in t)if(t.hasOwnProperty(a)&&!_[a])if(!e.additionalProperties){c.push({path:o,property:'additionalProperties',message:this.translate('error_additional_properties',[a])});break}else if(!0===e.additionalProperties)break;else c=c.concat(this._validateSchema(e.additionalProperties,t[a],o+'.'+a));if(e.dependencies)for(a in e.dependencies)if(e.dependencies.hasOwnProperty(a)&&'undefined'!=typeof t[a])if(Array.isArray(e.dependencies[a]))for(i=0;i<e.dependencies[a].length;i++)'undefined'==typeof t[e.dependencies[a][i]]&&c.push({path:o,property:'dependencies',message:this.translate('error_dependency',[e.dependencies[a][i]])});else c=c.concat(this._validateSchema(e.dependencies[a],t,o))}return l(d.defaults.custom_validators,function(r,i){c=c.concat(i.call(p,e,t,o))}),this.options.custom_validators&&l(this.options.custom_validators,function(r,i){c=c.concat(i.call(p,e,t,o))}),c},_checkType:function(e,t){return'string'==typeof e?'string'===e?'string'==typeof t:'number'===e?'number'==typeof t:'integer'===e?'number'==typeof t&&t===r(t):'boolean'===e?'boolean'==typeof t:'array'===e?Array.isArray(t):'object'===e?null!==t&&!Array.isArray(t)&&'object'==typeof t:'null'!==e||null===t:!this._validateSchema(e,t).length}}),d.AbstractEditor=e.extend({onChildEditorChange:function(){this.onChange(!0)},notify:function(){this.jsoneditor.notifyWatchers(this.path)},change:function(){this.parent?this.parent.onChildEditorChange(this):this.jsoneditor.onChange()},onChange:function(e){this.notify(),this.watch_listener&&this.watch_listener(),e&&this.change()},register:function(){this.jsoneditor.registerEditor(this),this.onChange()},unregister:function(){this.jsoneditor&&this.jsoneditor.unregisterEditor(this)},getNumColumns:function(){return 12},init:function(e){this.jsoneditor=e.jsoneditor,this.theme=this.jsoneditor.theme,this.template_engine=this.jsoneditor.template,this.iconlib=this.jsoneditor.iconlib,this.translate=this.jsoneditor.translate||d.defaults.translate,this.original_schema=e.schema,this.schema=this.jsoneditor.expandSchema(this.original_schema),this.options=s({},this.options||{},e.schema.options||{},e),e.path||this.schema.id||(this.schema.id='root'),this.path=e.path||'root',this.formname=e.formname||this.path.replace(/\.([^.]+)/g,'[$1]'),this.jsoneditor.options.form_name_root&&(this.formname=this.formname.replace(/^root\[/,this.jsoneditor.options.form_name_root+'[')),this.key=this.path.split('.').pop(),this.parent=e.parent,this.link_watchers=[],e.container&&this.setContainer(e.container)},setContainer:function(e){this.container=e,this.schema.id&&this.container.setAttribute('data-schemaid',this.schema.id),this.schema.type&&'string'==typeof this.schema.type&&this.container.setAttribute('data-schematype',this.schema.type),this.container.setAttribute('data-schemapath',this.path)},preBuild:function(){},build:function(){},postBuild:function(){this.setupWatchListeners(),this.addLinks(),this.setValue(this.getDefault(),!0),this.updateHeaderText(),this.register(),this.onWatchedFieldChange()},setupWatchListeners:function(){var e=this;if(this.watched={},this.schema.vars&&(this.schema.watch=this.schema.vars),this.watched_values={},this.watch_listener=function(){e.refreshWatchedFieldValues()&&e.onWatchedFieldChange()},this.register(),this.schema.hasOwnProperty('watch')){var t,o,r,i,n;for(var a in this.schema.watch)if(this.schema.watch.hasOwnProperty(a)){if(t=this.schema.watch[a],Array.isArray(t)){if(2>t.length)continue;o=[t[0]].concat(t[1].split('.'))}else o=t.split('.'),e.theme.closest(e.container,'[data-schemaid="'+o[0]+'"]')||o.unshift('#');if(r=o.shift(),'#'===r&&(r=e.jsoneditor.schema.id||'root'),i=e.theme.closest(e.container,'[data-schemaid="'+r+'"]'),!i)throw'Could not find ancestor node with id '+r;n=i.getAttribute('data-schemapath')+'.'+o.join('.'),e.jsoneditor.watch(n,e.watch_listener),e.watched[a]=n}}this.schema.headerTemplate&&(this.header_template=this.jsoneditor.compileTemplate(this.schema.headerTemplate,this.template_engine))},addLinks:function(){if(!this.no_link_holder&&(this.link_holder=this.theme.getLinksHolder(),this.container.appendChild(this.link_holder),this.schema.links))for(var e=0;e<this.schema.links.length;e++)this.addLink(this.getLink(this.schema.links[e]))},getButton:function(e,t,o){var r='json-editor-btn-'+t;t=this.iconlib?this.iconlib.getIcon(t):null,!t&&o&&(e=o,o=null);var i=this.theme.getButton(e,t,o);return i.className+=' '+r+' ',i},setButtonText:function(e,t,o,r){return o=this.iconlib?this.iconlib.getIcon(o):null,!o&&r&&(t=r,r=null),this.theme.setButtonText(e,t,o,r)},addLink:function(e){this.link_holder&&this.link_holder.appendChild(e)},getLink:function(e){var t,o,r=e.mediaType||'application/javascript',i=r.split('/')[0],n=this.jsoneditor.compileTemplate(e.href,this.template_engine),a=null;if(e.download&&(a=e.download),a&&!0!==a&&(a=this.jsoneditor.compileTemplate(a,this.template_engine)),'image'===i){t=this.theme.getBlockLinkHolder(),o=document.createElement('a'),o.setAttribute('target','_blank');var s=document.createElement('img');this.theme.createImageLink(t,o,s),this.link_watchers.push(function(t){var r=n(t);o.setAttribute('href',r),o.setAttribute('title',e.rel||r),s.setAttribute('src',r)})}else if(0<=['audio','video'].indexOf(i)){t=this.theme.getBlockLinkHolder(),o=this.theme.getBlockLink(),o.setAttribute('target','_blank');var l=document.createElement(i);l.setAttribute('controls','controls'),this.theme.createMediaLink(t,o,l),this.link_watchers.push(function(t){var r=n(t);o.setAttribute('href',r),o.textContent=e.rel||r,l.setAttribute('src',r)})}else o=t=this.theme.getBlockLink(),t.setAttribute('target','_blank'),t.textContent=e.rel,this.link_watchers.push(function(o){var r=n(o);t.setAttribute('href',r),t.textContent=e.rel||r});return a&&o&&(!0===a?o.setAttribute('download',''):this.link_watchers.push(function(e){o.setAttribute('download',a(e))})),e.class&&(o.className=o.className+' '+e.class),t},refreshWatchedFieldValues:function(){if(this.watched_values){var e={},t=!1,o=this;if(this.watched){var r,i;for(var n in this.watched)this.watched.hasOwnProperty(n)&&(i=o.jsoneditor.getEditor(this.watched[n]),r=i?i.getValue():null,o.watched_values[n]!==r&&(t=!0),e[n]=r)}return e.self=this.getValue(),this.watched_values.self!==e.self&&(t=!0),this.watched_values=e,t}},getWatchedFieldValues:function(){return this.watched_values},updateHeaderText:function(){if(this.header)if(this.header.children.length){for(var e=0;e<this.header.childNodes.length;e++)if(3===this.header.childNodes[e].nodeType){this.header.childNodes[e].nodeValue=this.getHeaderText();break}}else this.header.textContent=this.getHeaderText()},getHeaderText:function(e){return this.header_text?this.header_text:e?this.schema.title:this.getTitle()},onWatchedFieldChange:function(){var e;if(this.header_template){e=s(this.getWatchedFieldValues(),{key:this.key,i:this.key,i0:1*this.key,i1:1*this.key+1,title:this.getTitle()});var t=this.header_template(e);t!==this.header_text&&(this.header_text=t,this.updateHeaderText(),this.notify())}if(this.link_watchers.length){e=this.getWatchedFieldValues();for(var o=0;o<this.link_watchers.length;o++)this.link_watchers[o](e)}},setValue:function(e){this.value=e},getValue:function(){return this.value},refreshValue:function(){},getChildEditors:function(){return!1},destroy:function(){var e=this;this.unregister(this),l(this.watched,function(t,o){e.jsoneditor.unwatch(o,e.watch_listener)}),this.watched=null,this.watched_values=null,this.watch_listener=null,this.header_text=null,this.header_template=null,this.value=null,this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.container=null,this.jsoneditor=null,this.schema=null,this.path=null,this.key=null,this.parent=null},getDefault:function(){if(this.schema['default'])return this.schema['default'];if(this.schema['enum'])return this.schema['enum'][0];var e=this.schema.type||this.schema.oneOf;if(e&&Array.isArray(e)&&(e=e[0]),e&&'object'==typeof e&&(e=e.type),e&&Array.isArray(e)&&(e=e[0]),'string'==typeof e){if('number'===e)return 0;if('boolean'===e)return!1;if('integer'===e)return 0;if('string'===e)return'';if('object'===e)return{};if('array'===e)return[]}return null},getTitle:function(){return this.schema.title||this.key},enable:function(){this.disabled=!1},disable:function(){this.disabled=!0},isEnabled:function(){return!this.disabled},isRequired:function(){return'boolean'==typeof this.schema.required?this.schema.required:this.parent&&this.parent.schema&&Array.isArray(this.parent.schema.required)?-1<this.parent.schema.required.indexOf(this.key):!!this.jsoneditor.options.required_by_default},getDisplayText:function(e){var t=[],o={};l(e,function(e,t){t.title&&(o[t.title]=o[t.title]||0,o[t.title]++),t.description&&(o[t.description]=o[t.description]||0,o[t.description]++),t.format&&(o[t.format]=o[t.format]||0,o[t.format]++),t.type&&(o[t.type]=o[t.type]||0,o[t.type]++)}),l(e,function(e,r){var i;i='string'==typeof r?r:r.title&&1>=o[r.title]?r.title:r.format&&1>=o[r.format]?r.format:r.type&&1>=o[r.type]?r.type:r.description&&1>=o[r.description]?r.descripton:r.title?r.title:r.format?r.format:r.type?r.type:r.description?r.description:50>JSON.stringify(r).length?JSON.stringify(r):'type',t.push(i)});var r={};return l(t,function(e,i){r[i]=r[i]||0,r[i]++,1<o[i]&&(t[e]=i+' '+r[i])}),t},getOption:function(e){try{throw'getOption is deprecated'}catch(t){window.console.error(t)}return this.options[e]},showValidationErrors:function(){}}),d.defaults.editors['null']=d.AbstractEditor.extend({getValue:function(){return null},setValue:function(){this.onChange()},getNumColumns:function(){return 2}}),d.defaults.editors.string=d.AbstractEditor.extend({register:function(){this._super();this.input&&this.input.setAttribute('name',this.formname)},unregister:function(){this._super();this.input&&this.input.removeAttribute('name')},setValue:function(e,t,o){this;if((!this.template||o)&&(null===e||'undefined'==typeof e?e='':'object'==typeof e?e=JSON.stringify(e):'string'!=typeof e&&(e=''+e),e!==this.serialized)){var r=this.sanitize(e);if(this.input.value!==r){this.input.value=r,this.sceditor_instance?this.sceditor_instance.val(r):this.epiceditor?this.epiceditor.importFile(null,r):this.ace_editor&&this.ace_editor.setValue(r);var i=o||this.getValue()!==e;this.refreshValue(),t?this.is_dirty=!1:'change'===this.jsoneditor.options.show_errors&&(this.is_dirty=!0),this.adjust_height&&this.adjust_height(this.input),this.onChange(i)}}},getNumColumns:function(){var e,r=o(n(this.getTitle().length,this.schema.maxLength||0,this.schema.minLength||0)/5);return e='textarea'===this.input_type?6:0<=['text','email'].indexOf(this.input_type)?4:2,t(12,n(r,e))},build:function(){var t=this;if(this.options.compact||(this.header=this.label=this.theme.getFormInputLabel(this.getTitle())),this.schema.description&&(this.description=this.theme.getFormInputDescription(this.schema.description)),this.format=this.schema.format,!this.format&&this.schema.media&&this.schema.media.type&&(this.format=this.schema.media.type.replace(/(^(application|text)\/(x-)?(script\.)?)|(-source$)/g,'')),!this.format&&this.options.default_format&&(this.format=this.options.default_format),this.options.format&&(this.format=this.options.format),!this.format)this.input_type='text',this.input=this.theme.getFormInputField(this.input_type);else if('textarea'===this.format)this.input_type='textarea',this.input=this.theme.getTextareaInput();else if('range'===this.format){this.input_type='range';var e=this.schema.minimum||0,i=this.schema.maximum||n(100,e+1),a=1;this.schema.multipleOf&&(e%this.schema.multipleOf&&(e=o(e/this.schema.multipleOf)*this.schema.multipleOf),i%this.schema.multipleOf&&(i=r(i/this.schema.multipleOf)*this.schema.multipleOf),a=this.schema.multipleOf),this.input=this.theme.getRangeInput(e,i,a)}else 0<=['actionscript','batchfile','bbcode','c','c++','cpp','coffee','csharp','css','dart','django','ejs','erlang','golang','groovy','handlebars','haskell','haxe','html','ini','jade','java','javascript','json','less','lisp','lua','makefile','markdown','matlab','mysql','objectivec','pascal','perl','pgsql','php','python','r','ruby','sass','scala','scss','smarty','sql','stylus','svg','twig','vbscript','xml','yaml'].indexOf(this.format)?(this.input_type=this.format,this.source_code=!0,this.input=this.theme.getTextareaInput()):(this.input_type=this.format,this.input=this.theme.getFormInputField(this.input_type));'undefined'!=typeof this.schema.maxLength&&this.input.setAttribute('maxlength',this.schema.maxLength),'undefined'==typeof this.schema.pattern?'undefined'!=typeof this.schema.minLength&&this.input.setAttribute('pattern','.{'+this.schema.minLength+',}'):this.input.setAttribute('pattern',this.schema.pattern),this.options.compact?this.container.className+=' compact':this.options.input_width&&(this.input.style.width=this.options.input_width),(this.schema.readOnly||this.schema.readonly||this.schema.template)&&(this.always_disabled=!0,this.input.disabled=!0),this.input.addEventListener('change',function(o){if(o.preventDefault(),o.stopPropagation(),t.schema.template)return void(this.value=t.value);var e=this.value,r=t.sanitize(e);e!==r&&(this.value=r),t.is_dirty=!0,t.refreshValue(),t.onChange(!0)}),this.options.input_height&&(this.input.style.height=this.options.input_height),this.options.expand_height&&(this.adjust_height=function(e){if(e){var t,o=e.offsetHeight;if(e.offsetHeight<e.scrollHeight)for(t=0;e.offsetHeight<e.scrollHeight+3&&!(100<t);)t++,o++,e.style.height=o+'px';else{for(t=0;e.offsetHeight>=e.scrollHeight+3&&!(100<t);)t++,o--,e.style.height=o+'px';e.style.height=o+1+'px'}}},this.input.addEventListener('keyup',function(){t.adjust_height(this)}),this.input.addEventListener('change',function(){t.adjust_height(this)}),this.adjust_height()),this.format&&this.input.setAttribute('data-schemaformat',this.format),this.control=this.theme.getFormControl(this.label,this.input,this.description),this.container.appendChild(this.control),window.requestAnimationFrame(function(){t.input.parentNode&&t.afterInputReady(),t.adjust_height&&t.adjust_height(t.input)}),this.schema.template?(this.template=this.jsoneditor.compileTemplate(this.schema.template,this.template_engine),this.refreshValue()):this.refreshValue()},enable:function(){this.always_disabled||(this.input.disabled=!1),this._super()},disable:function(){this.input.disabled=!0,this._super()},afterInputReady:function(){var e,t=this;if(this.source_code)if(this.options.wysiwyg&&0<=['html','bbcode'].indexOf(this.input_type)&&window.jQuery&&window.jQuery.fn&&window.jQuery.fn.sceditor)e=s({},{plugins:'html'===t.input_type?'xhtml':'bbcode',emoticonsEnabled:!1,width:'100%',height:300},d.plugins.sceditor,t.options.sceditor_options||{}),window.jQuery(t.input).sceditor(e),t.sceditor_instance=window.jQuery(t.input).sceditor('instance'),t.sceditor_instance.blur(function(){var e=window.jQuery('<div>'+t.sceditor_instance.val()+'</div>');window.jQuery('#sceditor-start-marker,#sceditor-end-marker,.sceditor-nlf',e).remove(),t.input.value=e.html(),t.value=t.input.value,t.is_dirty=!0,t.onChange(!0)});else if('markdown'===this.input_type&&window.EpicEditor)this.epiceditor_container=document.createElement('div'),this.input.parentNode.insertBefore(this.epiceditor_container,this.input),this.input.style.display='none',e=s({},d.plugins.epiceditor,{container:this.epiceditor_container,clientSideStorage:!1}),this.epiceditor=new window.EpicEditor(e).load(),this.epiceditor.importFile(null,this.getValue()),this.epiceditor.on('update',function(){var e=t.epiceditor.exportFile();t.input.value=e,t.value=e,t.is_dirty=!0,t.onChange(!0)});else if(window.ace){var o=this.input_type;('cpp'===o||'c++'===o||'c'===o)&&(o='c_cpp'),this.ace_container=document.createElement('div'),this.ace_container.style.width='100%',this.ace_container.style.position='relative',this.ace_container.style.height='400px',this.input.parentNode.insertBefore(this.ace_container,this.input),this.input.style.display='none',this.ace_editor=window.ace.edit(this.ace_container),this.ace_editor.setValue(this.getValue()),d.plugins.ace.theme&&this.ace_editor.setTheme('ace/theme/'+d.plugins.ace.theme),o=window.ace.require('ace/mode/'+o),o&&this.ace_editor.getSession().setMode(new o.Mode),this.ace_editor.on('change',function(){var e=t.ace_editor.getValue();t.input.value=e,t.refreshValue(),t.is_dirty=!0,t.onChange(!0)})}t.theme.afterInputReady(t.input)},refreshValue:function(){this.value=this.input.value,'string'!=typeof this.value&&(this.value=''),this.serialized=this.value},destroy:function(){this.sceditor_instance?this.sceditor_instance.destroy():this.epiceditor?this.epiceditor.unload():this.ace_editor&&this.ace_editor.destroy(),this.template=null,this.input&&this.input.parentNode&&this.input.parentNode.removeChild(this.input),this.label&&this.label.parentNode&&this.label.parentNode.removeChild(this.label),this.description&&this.description.parentNode&&this.description.parentNode.removeChild(this.description),this._super()},sanitize:function(e){return e},onWatchedFieldChange:function(){var e,t=this;this.template&&(e=this.getWatchedFieldValues(),this.setValue(this.template(e),!1,!0)),this._super()},showValidationErrors:function(e){var t=this;if('always'===this.jsoneditor.options.show_errors);else if(!this.is_dirty&&this.previous_error_setting===this.jsoneditor.options.show_errors)return;this.previous_error_setting=this.jsoneditor.options.show_errors;var o=[];l(e,function(e,r){r.path===t.path&&o.push(r.message)}),o.length?this.theme.addInputError(this.input,o.join('. ')+'.'):this.theme.removeInputError(this.input)}}),d.defaults.editors.number=d.defaults.editors.string.extend({sanitize:function(e){return(e+'').replace(/[^0-9\.\-eE]/g,'')},getNumColumns:function(){return 2},getValue:function(){return 1*this.value}}),d.defaults.editors.integer=d.defaults.editors.number.extend({sanitize:function(e){return e+='',e.replace(/[^0-9\-]/g,'')},getNumColumns:function(){return 2}}),d.defaults.editors.object=d.AbstractEditor.extend({getDefault:function(){return s({},this.schema['default']||{})},getChildEditors:function(){return this.editors},register:function(){if(this._super(),this.editors)for(var e in this.editors)this.editors.hasOwnProperty(e)&&this.editors[e].register()},unregister:function(){if(this._super(),this.editors)for(var e in this.editors)this.editors.hasOwnProperty(e)&&this.editors[e].unregister()},getNumColumns:function(){return n(t(12,this.maxwidth),3)},enable:function(){if(this.editjson_button&&(this.editjson_button.disabled=!1),this.addproperty_button&&(this.addproperty_button.disabled=!1),this._super(),this.editors)for(var e in this.editors)this.editors.hasOwnProperty(e)&&this.editors[e].enable()},disable:function(){if(this.editjson_button&&(this.editjson_button.disabled=!0),this.addproperty_button&&(this.addproperty_button.disabled=!0),this.hideEditJSON(),this._super(),this.editors)for(var e in this.editors)this.editors.hasOwnProperty(e)&&this.editors[e].disable()},layoutEditors:function(){var e,o,s=this;if(this.row_container){this.property_order=Object.keys(this.editors),this.property_order=this.property_order.sort(function(e,t){var o=s.editors[e].schema.propertyOrder,r=s.editors[t].schema.propertyOrder;return'number'!=typeof o&&(o=1e3),'number'!=typeof r&&(r=1e3),o-r});var i;if('grid'===this.format){var a=[];for(l(this.property_order,function(e,o){var r=s.editors[o];if(!r.property_removed){for(var l=!1,d=r.options.hidden?0:r.options.grid_columns||r.getNumColumns(),p=r.options.hidden?0:r.container.offsetHeight,c=0;c<a.length;c++)12>=a[c].width+d&&(!p||0.5*a[c].minh<p&&2*a[c].maxh>p)&&(l=c);!1===l&&(a.push({width:0,minh:999999,maxh:0,editors:[]}),l=a.length-1),a[l].editors.push({key:o,width:d,height:p}),a[l].width+=d,a[l].minh=t(a[l].minh,p),a[l].maxh=n(a[l].maxh,p)}}),e=0;e<a.length;e++)if(12>a[e].width){var d=!1,p=0;for(o=0;o<a[e].editors.length;o++)!1==d?d=o:a[e].editors[o].width>a[e].editors[d].width&&(d=o),a[e].editors[o].width*=12/a[e].width,a[e].editors[o].width=r(a[e].editors[o].width),p+=a[e].editors[o].width;12>p&&(a[e].editors[d].width+=12-p),a[e].width=12}if(this.layout===JSON.stringify(a))return!1;for(this.layout=JSON.stringify(a),i=document.createElement('div'),e=0;e<a.length;e++){var c=this.theme.getGridRow();for(i.appendChild(c),o=0;o<a[e].editors.length;o++){var u=a[e].editors[o].key,m=this.editors[u];m.options.hidden?m.container.style.display='none':this.theme.setGridColumnSize(m.container,a[e].editors[o].width),c.appendChild(m.container)}}}else i=document.createElement('div'),l(this.property_order,function(e,t){var o=s.editors[t];if(!o.property_removed){var r=s.theme.getGridRow();i.appendChild(r),o.options.hidden?o.container.style.display='none':s.theme.setGridColumnSize(o.container,12),r.appendChild(o.container)}});this.row_container.innerHTML='',this.row_container.appendChild(i)}},getPropertySchema:function(e){var t=this.schema.properties[e]||{};t=s({},t);var o=!!this.schema.properties[e];if(this.schema.patternProperties)for(var r in this.schema.patternProperties)if(this.schema.patternProperties.hasOwnProperty(r)){var i=new RegExp(r);i.test(e)&&(t.allOf=t.allOf||[],t.allOf.push(this.schema.patternProperties[r]),o=!0)}return!o&&this.schema.additionalProperties&&'object'==typeof this.schema.additionalProperties&&(t=s({},this.schema.additionalProperties)),t},preBuild:function(){this._super(),this.editors={},this.cached_editors={};var e=this;if(this.format=this.options.layout||this.options.object_layout||this.schema.format||this.jsoneditor.options.object_layout||'normal',this.schema.properties=this.schema.properties||{},this.minwidth=0,this.maxwidth=0,this.options.table_row)l(this.schema.properties,function(t,o){var r=e.jsoneditor.getEditorClass(o);e.editors[t]=e.jsoneditor.createEditor(r,{jsoneditor:e.jsoneditor,schema:o,path:e.path+'.'+t,parent:e,compact:!0,required:!0}),e.editors[t].preBuild();var i=e.editors[t].options.hidden?0:e.editors[t].options.grid_columns||e.editors[t].getNumColumns();e.minwidth+=i,e.maxwidth+=i}),this.no_link_holder=!0;else if(this.options.table)throw'Not supported yet';else this.schema.defaultProperties||(this.jsoneditor.options.display_required_only||this.options.display_required_only?(this.schema.defaultProperties=[],l(this.schema.properties,function(t,o){e.isRequired({key:t,schema:o})&&e.schema.defaultProperties.push(t)})):e.schema.defaultProperties=Object.keys(e.schema.properties)),e.maxwidth+=1,l(this.schema.defaultProperties,function(t,o){e.addObjectProperty(o,!0),e.editors[o]&&(e.minwidth=n(e.minwidth,e.editors[o].options.grid_columns||e.editors[o].getNumColumns()),e.maxwidth+=e.editors[o].options.grid_columns||e.editors[o].getNumColumns())});this.property_order=Object.keys(this.editors),this.property_order=this.property_order.sort(function(t,o){var r=e.editors[t].schema.propertyOrder,i=e.editors[o].schema.propertyOrder;return'number'!=typeof r&&(r=1e3),'number'!=typeof i&&(i=1e3),r-i})},build:function(){var t=this;if(this.options.table_row)this.editor_holder=this.container,l(this.editors,function(e,o){var r=t.theme.getTableCell();t.editor_holder.appendChild(r),o.setContainer(r),o.build(),o.postBuild(),t.editors[e].options.hidden&&(r.style.display='none'),t.editors[e].options.input_width&&(r.style.width=t.editors[e].options.input_width)});else if(this.options.table)throw'Not supported yet';else{this.header=document.createElement('span'),this.header.textContent=this.getTitle(),this.title=this.theme.getHeader(this.header),this.container.appendChild(this.title),this.container.style.position='relative',this.editjson_holder=this.theme.getModal(),this.editjson_textarea=this.theme.getTextareaInput(),this.editjson_textarea.style.height='170px',this.editjson_textarea.style.width='300px',this.editjson_textarea.style.display='block',this.editjson_save=this.getButton('Save','save','Save'),this.editjson_save.addEventListener('click',function(o){o.preventDefault(),o.stopPropagation(),t.saveJSON()}),this.editjson_cancel=this.getButton('Cancel','cancel','Cancel'),this.editjson_cancel.addEventListener('click',function(o){o.preventDefault(),o.stopPropagation(),t.hideEditJSON()}),this.editjson_holder.appendChild(this.editjson_textarea),this.editjson_holder.appendChild(this.editjson_save),this.editjson_holder.appendChild(this.editjson_cancel),this.addproperty_holder=this.theme.getModal(),this.addproperty_list=document.createElement('div'),this.addproperty_list.style.width='295px',this.addproperty_list.style.maxHeight='160px',this.addproperty_list.style.padding='5px 0',this.addproperty_list.style.overflowY='auto',this.addproperty_list.style.overflowX='hidden',this.addproperty_list.style.paddingLeft='5px',this.addproperty_list.setAttribute('class','property-selector'),this.addproperty_add=this.getButton('add','add','add'),this.addproperty_input=this.theme.getFormInputField('text'),this.addproperty_input.setAttribute('placeholder','Property name...'),this.addproperty_input.style.width='220px',this.addproperty_input.style.marginBottom='0',this.addproperty_input.style.display='inline-block',this.addproperty_add.addEventListener('click',function(o){if(o.preventDefault(),o.stopPropagation(),t.addproperty_input.value){if(t.editors[t.addproperty_input.value])return void window.alert('there is already a property with that name');t.addObjectProperty(t.addproperty_input.value),t.editors[t.addproperty_input.value]&&t.editors[t.addproperty_input.value].disable(),t.onChange(!0)}}),this.addproperty_holder.appendChild(this.addproperty_list),this.addproperty_holder.appendChild(this.addproperty_input),this.addproperty_holder.appendChild(this.addproperty_add);var e=document.createElement('div');e.style.clear='both',this.addproperty_holder.appendChild(e),this.schema.description&&(this.description=this.theme.getDescription(this.schema.description),this.container.appendChild(this.description)),this.error_holder=document.createElement('div'),this.container.appendChild(this.error_holder),this.editor_holder=this.theme.getIndentedPanel(),this.container.appendChild(this.editor_holder),this.row_container=this.theme.getGridContainer(),this.editor_holder.appendChild(this.row_container),l(this.editors,function(e,o){var r=t.theme.getGridColumn();t.row_container.appendChild(r),o.setContainer(r),o.build(),o.postBuild()}),this.title_controls=this.theme.getHeaderButtonHolder(),this.editjson_controls=this.theme.getHeaderButtonHolder(),this.addproperty_controls=this.theme.getHeaderButtonHolder(),this.title.appendChild(this.title_controls),this.title.appendChild(this.editjson_controls),this.title.appendChild(this.addproperty_controls),this.collapsed=!1,this.toggle_button=this.getButton('','collapse',this.translate('button_collapse')),this.title_controls.appendChild(this.toggle_button),this.toggle_button.addEventListener('click',function(o){o.preventDefault(),o.stopPropagation(),t.collapsed?(t.editor_holder.style.display='',t.collapsed=!1,t.setButtonText(t.toggle_button,'','collapse',t.translate('button_collapse'))):(t.editor_holder.style.display='none',t.collapsed=!0,t.setButtonText(t.toggle_button,'','expand',t.translate('button_expand')))}),this.options.collapsed&&i(this.toggle_button,'click'),this.schema.options&&'undefined'!=typeof this.schema.options.disable_collapse?this.schema.options.disable_collapse&&(this.toggle_button.style.display='none'):this.jsoneditor.options.disable_collapse&&(this.toggle_button.style.display='none'),this.editjson_button=this.getButton('JSON','edit','Edit JSON'),this.editjson_button.addEventListener('click',function(o){o.preventDefault(),o.stopPropagation(),t.toggleEditJSON()}),this.editjson_controls.appendChild(this.editjson_button),this.editjson_controls.appendChild(this.editjson_holder),this.schema.options&&'undefined'!=typeof this.schema.options.disable_edit_json?this.schema.options.disable_edit_json&&(this.editjson_button.style.display='none'):this.jsoneditor.options.disable_edit_json&&(this.editjson_button.style.display='none'),this.addproperty_button=this.getButton('Properties','edit','Object Properties'),this.addproperty_button.addEventListener('click',function(o){o.preventDefault(),o.stopPropagation(),t.toggleAddProperty()}),this.addproperty_controls.appendChild(this.addproperty_button),this.addproperty_controls.appendChild(this.addproperty_holder),this.refreshAddProperties()}this.options.table_row?(this.editor_holder=this.container,l(this.property_order,function(e,o){t.editor_holder.appendChild(t.editors[o].container)})):(this.layoutEditors(),this.layoutEditors())},showEditJSON:function(){this.editjson_holder&&(this.hideAddProperty(),this.editjson_holder.style.left=this.editjson_button.offsetLeft+'px',this.editjson_holder.style.top=this.editjson_button.offsetTop+this.editjson_button.offsetHeight+'px',this.editjson_textarea.value=JSON.stringify(this.getValue(),null,2),this.disable(),this.editjson_holder.style.display='',this.editjson_button.disabled=!1,this.editing_json=!0)},hideEditJSON:function(){this.editjson_holder&&this.editing_json&&(this.editjson_holder.style.display='none',this.enable(),this.editing_json=!1)},saveJSON:function(){if(this.editjson_holder)try{var e=JSON.parse(this.editjson_textarea.value);this.setValue(e),this.hideEditJSON()}catch(t){throw window.alert('invalid JSON'),t}},toggleEditJSON:function(){this.editing_json?this.hideEditJSON():this.showEditJSON()},insertPropertyControlUsingPropertyOrder:function(e,t,o){var r;this.schema.properties[e]&&(r=this.schema.properties[e].propertyOrder),'number'!=typeof r&&(r=1e3),t.propertyOrder=r;for(var n,a=0;a<o.childNodes.length;a++)if(n=o.childNodes[a],t.propertyOrder<n.propertyOrder){this.addproperty_list.insertBefore(t,n),t=null;break}t&&this.addproperty_list.appendChild(t)},addPropertyCheckbox:function(e){var t,o,r,i,n=this;return t=n.theme.getCheckbox(),t.style.width='auto',r=this.schema.properties[e]&&this.schema.properties[e].title?this.schema.properties[e].title:e,o=n.theme.getCheckboxLabel(r),i=n.theme.getFormControl(o,t),i.style.paddingBottom=i.style.marginBottom=i.style.paddingTop=i.style.marginTop=0,i.style.height='auto',this.insertPropertyControlUsingPropertyOrder(e,i,this.addproperty_list),t.checked=e in this.editors,t.addEventListener('change',function(){t.checked?n.addObjectProperty(e):n.removeObjectProperty(e),n.onChange(!0)}),n.addproperty_checkboxes[e]=t,t},showAddProperty:function(){this.addproperty_holder&&(this.hideEditJSON(),this.addproperty_holder.style.left=this.addproperty_button.offsetLeft+'px',this.addproperty_holder.style.top=this.addproperty_button.offsetTop+this.addproperty_button.offsetHeight+'px',this.disable(),this.adding_property=!0,this.addproperty_button.disabled=!1,this.addproperty_holder.style.display='',this.refreshAddProperties())},hideAddProperty:function(){this.addproperty_holder&&this.adding_property&&(this.addproperty_holder.style.display='none',this.enable(),this.adding_property=!1)},toggleAddProperty:function(){this.adding_property?this.hideAddProperty():this.showAddProperty()},removeObjectProperty:function(e){this.editors[e]&&(this.editors[e].unregister(),delete this.editors[e],this.refreshValue(),this.layoutEditors())},addObjectProperty:function(e,t){var o=this;if(!this.editors[e]){if(this.cached_editors[e]){if(this.editors[e]=this.cached_editors[e],t)return;this.editors[e].register()}else{if(!this.canHaveAdditionalProperties()&&(!this.schema.properties||!this.schema.properties[e]))return;var r=o.getPropertySchema(e),i=o.jsoneditor.getEditorClass(r);if(o.editors[e]=o.jsoneditor.createEditor(i,{jsoneditor:o.jsoneditor,schema:r,path:o.path+'.'+e,parent:o}),o.editors[e].preBuild(),!t){var n=o.theme.getChildEditorHolder();o.editor_holder.appendChild(n),o.editors[e].setContainer(n),o.editors[e].build(),o.editors[e].postBuild()}o.cached_editors[e]=o.editors[e]}t||(o.refreshValue(),o.layoutEditors())}},onChildEditorChange:function(e){this.refreshValue(),this._super(e)},canHaveAdditionalProperties:function(){return'boolean'==typeof this.schema.additionalProperties?this.schema.additionalProperties:!this.jsoneditor.options.no_additional_properties},destroy:function(){l(this.cached_editors,function(e,t){t.destroy()}),this.editor_holder&&(this.editor_holder.innerHTML=''),this.title&&this.title.parentNode&&this.title.parentNode.removeChild(this.title),this.error_holder&&this.error_holder.parentNode&&this.error_holder.parentNode.removeChild(this.error_holder),this.editors=null,this.cached_editors=null,this.editor_holder&&this.editor_holder.parentNode&&this.editor_holder.parentNode.removeChild(this.editor_holder),this.editor_holder=null,this._super()},getValue:function(){var e=this._super();if(this.jsoneditor.options.remove_empty_properties||this.options.remove_empty_properties)for(var t in e)e.hasOwnProperty(t)&&(e[t]||delete e[t]);return e},refreshValue:function(){this.value={};this;for(var e in this.editors)this.editors.hasOwnProperty(e)&&(this.value[e]=this.editors[e].getValue());this.adding_property&&this.refreshAddProperties()},refreshAddProperties:function(){if(this.options.disable_properties||!1!==this.options.disable_properties&&this.jsoneditor.options.disable_properties)return void(this.addproperty_controls.style.display='none');var e,t=!1,o=!1,r=0,i=!1;for(e in this.editors)this.editors.hasOwnProperty(e)&&r++;for(e in t=this.canHaveAdditionalProperties()&&!('undefined'!=typeof this.schema.maxProperties&&r>=this.schema.maxProperties),this.addproperty_checkboxes&&(this.addproperty_list.innerHTML=''),this.addproperty_checkboxes={},this.cached_editors)this.cached_editors.hasOwnProperty(e)&&(this.addPropertyCheckbox(e),this.isRequired(this.cached_editors[e])&&e in this.editors&&(this.addproperty_checkboxes[e].disabled=!0),'undefined'!=typeof this.schema.minProperties&&r<=this.schema.minProperties?(this.addproperty_checkboxes[e].disabled=this.addproperty_checkboxes[e].checked,!this.addproperty_checkboxes[e].checked&&(i=!0)):e in this.editors?(i=!0,o=!0):t||this.schema.properties.hasOwnProperty(e)?(this.addproperty_checkboxes[e].disabled=!1,i=!0):this.addproperty_checkboxes[e].disabled=!0);for(e in this.canHaveAdditionalProperties()&&(i=!0),this.schema.properties)this.schema.properties.hasOwnProperty(e)&&(this.cached_editors[e]||(i=!0,this.addPropertyCheckbox(e)));i?this.canHaveAdditionalProperties()?t?this.addproperty_add.disabled=!1:this.addproperty_add.disabled=!0:(this.addproperty_add.style.display='none',this.addproperty_input.style.display='none'):(this.hideAddProperty(),this.addproperty_controls.style.display='none')},isRequired:function(e){return'boolean'==typeof e.schema.required?e.schema.required:Array.isArray(this.schema.required)?-1<this.schema.required.indexOf(e.key):!!this.jsoneditor.options.required_by_default},setValue:function(e,t){var o=this;e=e||{},('object'!=typeof e||Array.isArray(e))&&(e={}),l(this.cached_editors,function(r,i){'undefined'==typeof e[r]?t||o.isRequired(i)?i.setValue(i.getDefault(),t):o.removeObjectProperty(r):(o.addObjectProperty(r),i.setValue(e[r],t))}),l(e,function(e,r){o.cached_editors[e]||(o.addObjectProperty(e),o.editors[e]&&o.editors[e].setValue(r,t))}),this.refreshValue(),this.layoutEditors(),this.onChange()},showValidationErrors:function(e){var t=this,o=[],r=[];if(l(e,function(e,i){i.path===t.path?o.push(i):r.push(i)}),this.error_holder)if(o.length){this.error_holder.innerHTML='',this.error_holder.style.display='',l(o,function(e,o){t.error_holder.appendChild(t.theme.getErrorMessage(o.message))})}else this.error_holder.style.display='none';this.options.table_row&&(o.length?this.theme.addTableRowError(this.container):this.theme.removeTableRowError(this.container)),l(this.editors,function(e,t){t.showValidationErrors(r)})}}),d.defaults.editors.array=d.AbstractEditor.extend({getDefault:function(){return this.schema['default']||[]},register:function(){if(this._super(),this.rows)for(var e=0;e<this.rows.length;e++)this.rows[e].register()},unregister:function(){if(this._super(),this.rows)for(var e=0;e<this.rows.length;e++)this.rows[e].unregister()},getNumColumns:function(){var e=this.getItemInfo(0);return this.tabs_holder?n(t(12,e.width+2),4):e.width},enable:function(){if(this.add_row_button&&(this.add_row_button.disabled=!1),this.remove_all_rows_button&&(this.remove_all_rows_button.disabled=!1),this.delete_last_row_button&&(this.delete_last_row_button.disabled=!1),this.rows)for(var e=0;e<this.rows.length;e++)this.rows[e].enable(),this.rows[e].moveup_button&&(this.rows[e].moveup_button.disabled=!1),this.rows[e].movedown_button&&(this.rows[e].movedown_button.disabled=!1),this.rows[e].delete_button&&(this.rows[e].delete_button.disabled=!1);this._super()},disable:function(){if(this.add_row_button&&(this.add_row_button.disabled=!0),this.remove_all_rows_button&&(this.remove_all_rows_button.disabled=!0),this.delete_last_row_button&&(this.delete_last_row_button.disabled=!0),this.rows)for(var e=0;e<this.rows.length;e++)this.rows[e].disable(),this.rows[e].moveup_button&&(this.rows[e].moveup_button.disabled=!0),this.rows[e].movedown_button&&(this.rows[e].movedown_button.disabled=!0),this.rows[e].delete_button&&(this.rows[e].delete_button.disabled=!0);this._super()},preBuild:function(){this._super(),this.rows=[],this.row_cache=[],this.hide_delete_buttons=this.options.disable_array_delete||this.jsoneditor.options.disable_array_delete,this.hide_delete_all_rows_buttons=this.hide_delete_buttons||this.options.disable_array_delete_all_rows||this.jsoneditor.options.disable_array_delete_all_rows,this.hide_delete_last_row_buttons=this.hide_delete_buttons||this.options.disable_array_delete_last_row||this.jsoneditor.options.disable_array_delete_last_row,this.hide_move_buttons=this.options.disable_array_reorder||this.jsoneditor.options.disable_array_reorder,this.hide_add_button=this.options.disable_array_add||this.jsoneditor.options.disable_array_add},build:function(){this;this.options.compact?(this.panel=this.theme.getIndentedPanel(),this.container.appendChild(this.panel),this.controls=this.theme.getButtonHolder(),this.panel.appendChild(this.controls),this.row_holder=document.createElement('div'),this.panel.appendChild(this.row_holder)):(this.header=document.createElement('span'),this.header.textContent=this.getTitle(),this.title=this.theme.getHeader(this.header),this.container.appendChild(this.title),this.title_controls=this.theme.getHeaderButtonHolder(),this.title.appendChild(this.title_controls),this.schema.description&&(this.description=this.theme.getDescription(this.schema.description),this.container.appendChild(this.description)),this.error_holder=document.createElement('div'),this.container.appendChild(this.error_holder),'tabs'===this.schema.format?(this.controls=this.theme.getHeaderButtonHolder(),this.title.appendChild(this.controls),this.tabs_holder=this.theme.getTabHolder(),this.container.appendChild(this.tabs_holder),this.row_holder=this.theme.getTabContentHolder(this.tabs_holder),this.active_tab=null):(this.panel=this.theme.getIndentedPanel(),this.container.appendChild(this.panel),this.row_holder=document.createElement('div'),this.panel.appendChild(this.row_holder),this.controls=this.theme.getButtonHolder(),this.panel.appendChild(this.controls))),this.addControls()},onChildEditorChange:function(e){this.refreshValue(),this.refreshTabs(!0),this._super(e)},getItemTitle:function(){if(!this.item_title)if(this.schema.items&&!Array.isArray(this.schema.items)){var e=this.jsoneditor.expandRefs(this.schema.items);this.item_title=e.title||'item'}else this.item_title='item';return this.item_title},getItemSchema:function(e){if(!Array.isArray(this.schema.items))return this.schema.items?s({},this.schema.items):{};else if(e>=this.schema.items.length){if(!0===this.schema.additionalItems)return{};if(this.schema.additionalItems)return s({},this.schema.additionalItems)}else return s({},this.schema.items[e])},getItemInfo:function(e){var t=this.getItemSchema(e);this.item_info=this.item_info||{};var o=JSON.stringify(t);return'undefined'==typeof this.item_info[o]?(t=this.jsoneditor.expandRefs(t),this.item_info[o]={title:t.title||'item',default:t['default'],width:12,child_editors:t.properties||t.items},this.item_info[o]):this.item_info[o]},getElementEditor:function(e){var t=this.getItemInfo(e),o=this.getItemSchema(e);o=this.jsoneditor.expandRefs(o),o.title=t.title+' '+(e+1);var r,i=this.jsoneditor.getEditorClass(o);r=this.tabs_holder?this.theme.getTabContent():t.child_editors?this.theme.getChildEditorHolder():this.theme.getIndentedPanel(),this.row_holder.appendChild(r);var n=this.jsoneditor.createEditor(i,{jsoneditor:this.jsoneditor,schema:o,container:r,path:this.path+'.'+e,parent:this,required:!0});return n.preBuild(),n.build(),n.postBuild(),n.title_controls||(n.array_controls=this.theme.getButtonHolder(),r.appendChild(n.array_controls)),n},destroy:function(){this.empty(!0),this.title&&this.title.parentNode&&this.title.parentNode.removeChild(this.title),this.description&&this.description.parentNode&&this.description.parentNode.removeChild(this.description),this.row_holder&&this.row_holder.parentNode&&this.row_holder.parentNode.removeChild(this.row_holder),this.controls&&this.controls.parentNode&&this.controls.parentNode.removeChild(this.controls),this.panel&&this.panel.parentNode&&this.panel.parentNode.removeChild(this.panel),this.rows=this.row_cache=this.title=this.description=this.row_holder=this.panel=this.controls=null,this._super()},empty:function(e){if(this.rows){var t=this;l(this.rows,function(o,r){e&&(r.tab&&r.tab.parentNode&&r.tab.parentNode.removeChild(r.tab),t.destroyRow(r,!0),t.row_cache[o]=null),t.rows[o]=null}),t.rows=[],e&&(t.row_cache=[])}},destroyRow:function(e,t){var o=e.container;t?(e.destroy(),o.parentNode&&o.parentNode.removeChild(o),e.tab&&e.tab.parentNode&&e.tab.parentNode.removeChild(e.tab)):(e.tab&&(e.tab.style.display='none'),o.style.display='none',e.unregister())},getMax:function(){return Array.isArray(this.schema.items)&&!1===this.schema.additionalItems?t(this.schema.items.length,this.schema.maxItems||Infinity):this.schema.maxItems||Infinity},refreshTabs:function(e){var t=this;l(this.rows,function(o,r){r.tab&&(e?r.tab_text.textContent=r.getHeaderText():r.tab===t.active_tab?(t.theme.markTabActive(r.tab),r.container.style.display=''):(t.theme.markTabInactive(r.tab),r.container.style.display='none'))})},setValue:function(e,t){e=e||[],Array.isArray(e)||(e=[e]);var o=JSON.stringify(e);if(o!==this.serialized){if(this.schema.minItems)for(;e.length<this.schema.minItems;)e.push(this.getItemInfo(e.length)['default']);this.getMax()&&e.length>this.getMax()&&(e=e.slice(0,this.getMax()));var r=this;l(e,function(e,o){r.rows[e]?r.rows[e].setValue(o,t):r.row_cache[e]?(r.rows[e]=r.row_cache[e],r.rows[e].setValue(o,t),r.rows[e].container.style.display='',r.rows[e].tab&&(r.rows[e].tab.style.display=''),r.rows[e].register()):r.addRow(o,t)});for(var i=e.length;i<r.rows.length;i++)r.destroyRow(r.rows[i]),r.rows[i]=null;r.rows=r.rows.slice(0,e.length);var n=null;l(r.rows,function(e,t){if(t.tab===r.active_tab)return n=t.tab,!1}),!n&&r.rows.length&&(n=r.rows[0].tab),r.active_tab=n,r.refreshValue(t),r.refreshTabs(!0),r.refreshTabs(),r.onChange()}},refreshValue:function(e){var t=this,o=this.value?this.value.length:0;if(this.value=[],l(this.rows,function(e,o){t.value[e]=o.getValue()}),o!==this.value.length||e){var r=this.schema.minItems&&this.schema.minItems>=this.rows.length;l(this.rows,function(e,o){o.movedown_button&&(e===t.rows.length-1?o.movedown_button.style.display='none':o.movedown_button.style.display=''),o.delete_button&&(r?o.delete_button.style.display='none':o.delete_button.style.display=''),t.value[e]=o.getValue()});var i=!1;this.value.length?1===this.value.length?(this.remove_all_rows_button.style.display='none',r||this.hide_delete_last_row_buttons?this.delete_last_row_button.style.display='none':(this.delete_last_row_button.style.display='',i=!0)):(r||this.hide_delete_last_row_buttons?this.delete_last_row_button.style.display='none':(this.delete_last_row_button.style.display='',i=!0),r||this.hide_delete_all_rows_buttons?this.remove_all_rows_button.style.display='none':(this.remove_all_rows_button.style.display='',i=!0)):(this.delete_last_row_button.style.display='none',this.remove_all_rows_button.style.display='none'),this.getMax()&&this.getMax()<=this.rows.length||this.hide_add_button?this.add_row_button.style.display='none':(this.add_row_button.style.display='',i=!0),this.controls.style.display=!this.collapsed&&i?'inline-block':'none'}},addRow:function(e,t){var o=this,r=this.rows.length;o.rows[r]=this.getElementEditor(r),o.row_cache[r]=o.rows[r],o.tabs_holder&&(o.rows[r].tab_text=document.createElement('span'),o.rows[r].tab_text.textContent=o.rows[r].getHeaderText(),o.rows[r].tab=o.theme.getTab(o.rows[r].tab_text),o.rows[r].tab.addEventListener('click',function(t){o.active_tab=o.rows[r].tab,o.refreshTabs(),t.preventDefault(),t.stopPropagation()}),o.theme.addTab(o.tabs_holder,o.rows[r].tab));var i=o.rows[r].title_controls||o.rows[r].array_controls;o.hide_delete_buttons||(o.rows[r].delete_button=this.getButton(o.getItemTitle(),'delete',this.translate('button_delete_row_title',[o.getItemTitle()])),o.rows[r].delete_button.className+=' delete',o.rows[r].delete_button.setAttribute('data-i',r),o.rows[r].delete_button.addEventListener('click',function(t){t.preventDefault(),t.stopPropagation();var e=1*this.getAttribute('data-i'),r=o.getValue(),i=[],n=null;l(r,function(t,r){return t===e?void(o.rows[t].tab===o.active_tab&&(o.rows[t+1]?n=o.rows[t].tab:t&&(n=o.rows[t-1].tab))):void i.push(r)}),o.setValue(i),n&&(o.active_tab=n,o.refreshTabs()),o.onChange(!0)}),i&&i.appendChild(o.rows[r].delete_button)),r&&!o.hide_move_buttons&&(o.rows[r].moveup_button=this.getButton('','moveup',this.translate('button_move_up_title')),o.rows[r].moveup_button.className+=' moveup',o.rows[r].moveup_button.setAttribute('data-i',r),o.rows[r].moveup_button.addEventListener('click',function(t){t.preventDefault(),t.stopPropagation();var e=1*this.getAttribute('data-i');if(!(0>=e)){var r=o.getValue(),i=r[e-1];r[e-1]=r[e],r[e]=i,o.setValue(r),o.active_tab=o.rows[e-1].tab,o.refreshTabs(),o.onChange(!0)}}),i&&i.appendChild(o.rows[r].moveup_button)),o.hide_move_buttons||(o.rows[r].movedown_button=this.getButton('','movedown',this.translate('button_move_down_title')),o.rows[r].movedown_button.className+=' movedown',o.rows[r].movedown_button.setAttribute('data-i',r),o.rows[r].movedown_button.addEventListener('click',function(t){t.preventDefault(),t.stopPropagation();var e=1*this.getAttribute('data-i'),r=o.getValue();if(!(e>=r.length-1)){var i=r[e+1];r[e+1]=r[e],r[e]=i,o.setValue(r),o.active_tab=o.rows[e+1].tab,o.refreshTabs(),o.onChange(!0)}}),i&&i.appendChild(o.rows[r].movedown_button)),e&&o.rows[r].setValue(e,t),o.refreshTabs()},addControls:function(){var t=this;this.collapsed=!1,this.toggle_button=this.getButton('','collapse',this.translate('button_collapse')),this.title_controls.appendChild(this.toggle_button);var o=t.row_holder.style.display,r=t.controls.style.display;this.toggle_button.addEventListener('click',function(i){i.preventDefault(),i.stopPropagation(),t.collapsed?(t.collapsed=!1,t.panel&&(t.panel.style.display=''),t.row_holder.style.display=o,t.tabs_holder&&(t.tabs_holder.style.display=''),t.controls.style.display=r,t.setButtonText(this,'','collapse',t.translate('button_collapse'))):(t.collapsed=!0,t.row_holder.style.display='none',t.tabs_holder&&(t.tabs_holder.style.display='none'),t.controls.style.display='none',t.panel&&(t.panel.style.display='none'),t.setButtonText(this,'','expand',t.translate('button_expand')))}),this.options.collapsed&&i(this.toggle_button,'click'),this.schema.options&&'undefined'!=typeof this.schema.options.disable_collapse?this.schema.options.disable_collapse&&(this.toggle_button.style.display='none'):this.jsoneditor.options.disable_collapse&&(this.toggle_button.style.display='none'),this.add_row_button=this.getButton(this.getItemTitle(),'add',this.translate('button_add_row_title',[this.getItemTitle()])),this.add_row_button.addEventListener('click',function(o){o.preventDefault(),o.stopPropagation();var e=t.rows.length;t.row_cache[e]?(t.rows[e]=t.row_cache[e],t.rows[e].setValue(t.rows[e].getDefault(),!0),t.rows[e].container.style.display='',t.rows[e].tab&&(t.rows[e].tab.style.display=''),t.rows[e].register()):t.addRow(),t.active_tab=t.rows[e].tab,t.refreshTabs(),t.refreshValue(),t.onChange(!0)}),t.controls.appendChild(this.add_row_button),this.delete_last_row_button=this.getButton(this.translate('button_delete_last',[this.getItemTitle()]),'delete',this.translate('button_delete_last_title',[this.getItemTitle()])),this.delete_last_row_button.addEventListener('click',function(o){o.preventDefault(),o.stopPropagation();var e=t.getValue(),r=null;1<t.rows.length&&t.rows[t.rows.length-1].tab===t.active_tab&&(r=t.rows[t.rows.length-2].tab),e.pop(),t.setValue(e),r&&(t.active_tab=r,t.refreshTabs()),t.onChange(!0)}),t.controls.appendChild(this.delete_last_row_button),this.remove_all_rows_button=this.getButton(this.translate('button_delete_all'),'delete',this.translate('button_delete_all_title')),this.remove_all_rows_button.addEventListener('click',function(o){o.preventDefault(),o.stopPropagation(),t.setValue([]),t.onChange(!0)}),t.controls.appendChild(this.remove_all_rows_button),t.tabs&&(this.add_row_button.style.width='100%',this.add_row_button.style.textAlign='left',this.add_row_button.style.marginBottom='3px',this.delete_last_row_button.style.width='100%',this.delete_last_row_button.style.textAlign='left',this.delete_last_row_button.style.marginBottom='3px',this.remove_all_rows_button.style.width='100%',this.remove_all_rows_button.style.textAlign='left',this.remove_all_rows_button.style.marginBottom='3px')},showValidationErrors:function(e){var t=this,o=[],r=[];if(l(e,function(e,i){i.path===t.path?o.push(i):r.push(i)}),this.error_holder)if(o.length){this.error_holder.innerHTML='',this.error_holder.style.display='',l(o,function(e,o){t.error_holder.appendChild(t.theme.getErrorMessage(o.message))})}else this.error_holder.style.display='none';l(this.rows,function(e,t){t.showValidationErrors(r)})}}),d.defaults.editors.table=d.defaults.editors.array.extend({register:function(){if(this._super(),this.rows)for(var e=0;e<this.rows.length;e++)this.rows[e].register()},unregister:function(){if(this._super(),this.rows)for(var e=0;e<this.rows.length;e++)this.rows[e].unregister()},getNumColumns:function(){return n(t(12,this.width),3)},preBuild:function(){var e=this.jsoneditor.expandRefs(this.schema.items||{});this.item_title=e.title||'row',this.item_default=e['default']||null,this.item_has_child_editors=e.properties||e.items,this.width=12,this._super()},build:function(){var e=this;this.table=this.theme.getTable(),this.container.appendChild(this.table),this.thead=this.theme.getTableHead(),this.table.appendChild(this.thead),this.header_row=this.theme.getTableRow(),this.thead.appendChild(this.header_row),this.row_holder=this.theme.getTableBody(),this.table.appendChild(this.row_holder);var t=this.getElementEditor(0,!0);if(this.item_default=t.getDefault(),this.width=t.getNumColumns()+2,this.options.compact?(this.panel=document.createElement('div'),this.container.appendChild(this.panel)):(this.title=this.theme.getHeader(this.getTitle()),this.container.appendChild(this.title),this.title_controls=this.theme.getHeaderButtonHolder(),this.title.appendChild(this.title_controls),this.schema.description&&(this.description=this.theme.getDescription(this.schema.description),this.container.appendChild(this.description)),this.panel=this.theme.getIndentedPanel(),this.container.appendChild(this.panel),this.error_holder=document.createElement('div'),this.panel.appendChild(this.error_holder)),this.panel.appendChild(this.table),this.controls=this.theme.getButtonHolder(),this.panel.appendChild(this.controls),this.item_has_child_editors)for(var o,r=t.getChildEditors(),n=t.property_order||Object.keys(r),a=0;a<n.length;a++)o=e.theme.getTableHeaderCell(r[n[a]].getTitle()),r[n[a]].options.hidden&&(o.style.display='none'),e.header_row.appendChild(o);else e.header_row.appendChild(e.theme.getTableHeaderCell(this.item_title));t.destroy(),this.row_holder.innerHTML='',this.controls_header_cell=e.theme.getTableHeaderCell(' '),e.header_row.appendChild(this.controls_header_cell),this.addControls()},onChildEditorChange:function(){this.refreshValue(),this._super()},getItemDefault:function(){return s({},{default:this.item_default})['default']},getItemTitle:function(){return this.item_title},getElementEditor:function(e,t){var o=s({},this.schema.items),r=this.jsoneditor.getEditorClass(o,this.jsoneditor),i=this.row_holder.appendChild(this.theme.getTableRow()),n=i;this.item_has_child_editors||(n=this.theme.getTableCell(),i.appendChild(n));var a=this.jsoneditor.createEditor(r,{jsoneditor:this.jsoneditor,schema:o,container:n,path:this.path+'.'+e,parent:this,compact:!0,table_row:!0});return a.preBuild(),t||(a.build(),a.postBuild(),a.controls_cell=i.appendChild(this.theme.getTableCell()),a.row=i,a.table_controls=this.theme.getButtonHolder(),a.controls_cell.appendChild(a.table_controls),a.table_controls.style.margin=0,a.table_controls.style.padding=0),a},destroy:function(){this.innerHTML='',this.title&&this.title.parentNode&&this.title.parentNode.removeChild(this.title),this.description&&this.description.parentNode&&this.description.parentNode.removeChild(this.description),this.row_holder&&this.row_holder.parentNode&&this.row_holder.parentNode.removeChild(this.row_holder),this.table&&this.table.parentNode&&this.table.parentNode.removeChild(this.table),this.panel&&this.panel.parentNode&&this.panel.parentNode.removeChild(this.panel),this.rows=this.title=this.description=this.row_holder=this.table=this.panel=null,this._super()},setValue:function(e,t){if(e=e||[],this.schema.minItems)for(;e.length<this.schema.minItems;)e.push(this.getItemDefault());this.schema.maxItems&&e.length>this.schema.maxItems&&(e=e.slice(0,this.schema.maxItems));var o=JSON.stringify(e);if(o!==this.serialized){var r=!1,n=this;l(e,function(e,t){n.rows[e]?n.rows[e].setValue(t):(n.addRow(t),r=!0)});for(var i,a=e.length;a<n.rows.length;a++)i=n.rows[a].container,n.item_has_child_editors||n.rows[a].row.parentNode.removeChild(n.rows[a].row),n.rows[a].destroy(),i.parentNode&&i.parentNode.removeChild(i),n.rows[a]=null,r=!0;n.rows=n.rows.slice(0,e.length),n.refreshValue(),(r||t)&&n.refreshRowButtons(),n.onChange()}},refreshRowButtons:function(){var e=this,t=this.schema.minItems&&this.schema.minItems>=this.rows.length,o=!1;l(this.rows,function(r,i){i.movedown_button&&(r===e.rows.length-1?i.movedown_button.style.display='none':(o=!0,i.movedown_button.style.display='')),i.delete_button&&(t?i.delete_button.style.display='none':(o=!0,i.delete_button.style.display='')),i.moveup_button&&(o=!0)}),l(this.rows,function(e,t){t.controls_cell.style.display=o?'':'none'}),this.controls_header_cell.style.display=o?'':'none';var r=!1;this.value.length?1===this.value.length?(this.table.style.display='',this.remove_all_rows_button.style.display='none',t||this.hide_delete_last_row_buttons?this.delete_last_row_button.style.display='none':(this.delete_last_row_button.style.display='',r=!0)):(this.table.style.display='',t||this.hide_delete_last_row_buttons?this.delete_last_row_button.style.display='none':(this.delete_last_row_button.style.display='',r=!0),t||this.hide_delete_all_rows_buttons?this.remove_all_rows_button.style.display='none':(this.remove_all_rows_button.style.display='',r=!0)):(this.delete_last_row_button.style.display='none',this.remove_all_rows_button.style.display='none',this.table.style.display='none'),this.schema.maxItems&&this.schema.maxItems<=this.rows.length||this.hide_add_button?this.add_row_button.style.display='none':(this.add_row_button.style.display='',r=!0),this.controls.style.display=r?'':'none'},refreshValue:function(){var e=this;this.value=[],l(this.rows,function(t,o){e.value[t]=o.getValue()}),this.serialized=JSON.stringify(this.value)},addRow:function(e){var t=this,o=this.rows.length;t.rows[o]=this.getElementEditor(o);var r=t.rows[o].table_controls;this.hide_delete_buttons||(t.rows[o].delete_button=this.getButton('','delete',this.translate('button_delete_row_title_short')),t.rows[o].delete_button.className+=' delete',t.rows[o].delete_button.setAttribute('data-i',o),t.rows[o].delete_button.addEventListener('click',function(o){o.preventDefault(),o.stopPropagation();var e=1*this.getAttribute('data-i'),r=t.getValue(),i=[];l(r,function(t,o){t===e||i.push(o)}),t.setValue(i),t.onChange(!0)}),r.appendChild(t.rows[o].delete_button)),o&&!this.hide_move_buttons&&(t.rows[o].moveup_button=this.getButton('','moveup',this.translate('button_move_up_title')),t.rows[o].moveup_button.className+=' moveup',t.rows[o].moveup_button.setAttribute('data-i',o),t.rows[o].moveup_button.addEventListener('click',function(o){o.preventDefault(),o.stopPropagation();var e=1*this.getAttribute('data-i');if(!(0>=e)){var r=t.getValue(),i=r[e-1];r[e-1]=r[e],r[e]=i,t.setValue(r),t.onChange(!0)}}),r.appendChild(t.rows[o].moveup_button)),this.hide_move_buttons||(t.rows[o].movedown_button=this.getButton('','movedown',this.translate('button_move_down_title')),t.rows[o].movedown_button.className+=' movedown',t.rows[o].movedown_button.setAttribute('data-i',o),t.rows[o].movedown_button.addEventListener('click',function(o){o.preventDefault(),o.stopPropagation();var e=1*this.getAttribute('data-i'),r=t.getValue();if(!(e>=r.length-1)){var i=r[e+1];r[e+1]=r[e],r[e]=i,t.setValue(r),t.onChange(!0)}}),r.appendChild(t.rows[o].movedown_button)),e&&t.rows[o].setValue(e)},addControls:function(){var t=this;this.collapsed=!1,this.toggle_button=this.getButton('','collapse',this.translate('button_collapse')),this.title_controls&&(this.title_controls.appendChild(this.toggle_button),this.toggle_button.addEventListener('click',function(o){o.preventDefault(),o.stopPropagation(),t.collapsed?(t.collapsed=!1,t.panel.style.display='',t.setButtonText(this,'','collapse',t.translate('button_collapse'))):(t.collapsed=!0,t.panel.style.display='none',t.setButtonText(this,'','expand',t.translate('button_expand')))}),this.options.collapsed&&i(this.toggle_button,'click'),this.schema.options&&'undefined'!=typeof this.schema.options.disable_collapse?this.schema.options.disable_collapse&&(this.toggle_button.style.display='none'):this.jsoneditor.options.disable_collapse&&(this.toggle_button.style.display='none')),this.add_row_button=this.getButton(this.getItemTitle(),'add',this.translate('button_add_row_title',[this.getItemTitle()])),this.add_row_button.addEventListener('click',function(o){o.preventDefault(),o.stopPropagation(),t.addRow(),t.refreshValue(),t.refreshRowButtons(),t.onChange(!0)}),t.controls.appendChild(this.add_row_button),this.delete_last_row_button=this.getButton(this.translate('button_delete_last',[this.getItemTitle()]),'delete',this.translate('button_delete_last_title',[this.getItemTitle()])),this.delete_last_row_button.addEventListener('click',function(o){o.preventDefault(),o.stopPropagation();var e=t.getValue();e.pop(),t.setValue(e),t.onChange(!0)}),t.controls.appendChild(this.delete_last_row_button),this.remove_all_rows_button=this.getButton(this.translate('button_delete_all'),'delete',this.translate('button_delete_all_title')),this.remove_all_rows_button.addEventListener('click',function(o){o.preventDefault(),o.stopPropagation(),t.setValue([]),t.onChange(!0)}),t.controls.appendChild(this.remove_all_rows_button)}}),d.defaults.editors.multiple=d.AbstractEditor.extend({register:function(){if(this.editors){for(var e=0;e<this.editors.length;e++)this.editors[e]&&this.editors[e].unregister();this.editors[this.type]&&this.editors[this.type].register()}this._super()},unregister:function(){if(this._super(),this.editors)for(var e=0;e<this.editors.length;e++)this.editors[e]&&this.editors[e].unregister()},getNumColumns:function(){return this.editors[this.type]?n(this.editors[this.type].getNumColumns(),4):4},enable:function(){if(this.editors)for(var e=0;e<this.editors.length;e++)this.editors[e]&&this.editors[e].enable();this.switcher.disabled=!1,this._super()},disable:function(){if(this.editors)for(var e=0;e<this.editors.length;e++)this.editors[e]&&this.editors[e].disable();this.switcher.disabled=!0,this._super()},switchEditor:function(e){var t=this;this.editors[e]||this.buildChildEditor(e);var o=t.getValue();t.type=e,t.register(),l(t.editors,function(e,r){r&&(t.type===e?(t.keep_values&&r.setValue(o,!0),r.container.style.display=''):r.container.style.display='none')}),t.refreshValue(),t.refreshHeaderText()},buildChildEditor:function(e){var t=this,o=this.types[e],r=t.theme.getChildEditorHolder();t.editor_holder.appendChild(r);var i;'string'==typeof o?(i=s({},t.schema),i.type=o):(i=s({},t.schema,o),i=t.jsoneditor.expandRefs(i),o.required&&Array.isArray(o.required)&&t.schema.required&&Array.isArray(t.schema.required)&&(i.required=t.schema.required.concat(o.required)));var n=t.jsoneditor.getEditorClass(i);t.editors[e]=t.jsoneditor.createEditor(n,{jsoneditor:t.jsoneditor,schema:i,container:r,path:t.path,parent:t,required:!0}),t.editors[e].preBuild(),t.editors[e].build(),t.editors[e].postBuild(),t.editors[e].header&&(t.editors[e].header.style.display='none'),t.editors[e].option=t.switcher_options[e],r.addEventListener('change_header_text',function(){t.refreshHeaderText()}),e!==t.type&&(r.style.display='none')},preBuild:function(){this;if(this.types=[],this.type=0,this.editors=[],this.validators=[],this.keep_values=!0,'undefined'!=typeof this.jsoneditor.options.keep_oneof_values&&(this.keep_values=this.jsoneditor.options.keep_oneof_values),'undefined'!=typeof this.options.keep_oneof_values&&(this.keep_values=this.options.keep_oneof_values),this.schema.oneOf)this.oneOf=!0,this.types=this.schema.oneOf,delete this.schema.oneOf;else if(this.schema.anyOf)this.anyOf=!0,this.types=this.schema.anyOf,delete this.schema.anyOf;else{if(this.schema.type&&'any'!==this.schema.type)this.types=Array.isArray(this.schema.type)?this.schema.type:[this.schema.type];else if(this.types=['string','number','integer','boolean','object','array','null'],this.schema.disallow){var e=this.schema.disallow;'object'==typeof e&&Array.isArray(e)||(e=[e]);var t=[];l(this.types,function(o,r){-1===e.indexOf(r)&&t.push(r)}),this.types=t}delete this.schema.type}this.display_text=this.getDisplayText(this.types)},build:function(){var t=this,e=this.container;this.header=this.label=this.theme.getFormInputLabel(this.getTitle()),this.container.appendChild(this.header),this.switcher=this.theme.getSwitcher(this.display_text),e.appendChild(this.switcher),this.switcher.addEventListener('change',function(o){o.preventDefault(),o.stopPropagation(),t.switchEditor(t.display_text.indexOf(this.value)),t.onChange(!0)}),this.editor_holder=document.createElement('div'),e.appendChild(this.editor_holder);var o={};t.jsoneditor.options.custom_validators&&(o.custom_validators=t.jsoneditor.options.custom_validators),this.switcher_options=this.theme.getSwitcherOptions(this.switcher),l(this.types,function(e,r){t.editors[e]=!1;var i;'string'==typeof r?(i=s({},t.schema),i.type=r):(i=s({},t.schema,r),r.required&&Array.isArray(r.required)&&t.schema.required&&Array.isArray(t.schema.required)&&(i.required=t.schema.required.concat(r.required))),t.validators[e]=new d.Validator(t.jsoneditor,i,o)}),this.switchEditor(0)},onChildEditorChange:function(){this.editors[this.type]&&(this.refreshValue(),this.refreshHeaderText()),this._super()},refreshHeaderText:function(){var e=this.getDisplayText(this.types);l(this.switcher_options,function(t,o){o.textContent=e[t]})},refreshValue:function(){this.value=this.editors[this.type].getValue()},setValue:function(e,t){var o=this;l(this.validators,function(t,r){if(!r.validate(e).length)return o.type=t,o.switcher.value=o.display_text[t],!1}),this.switchEditor(this.type),this.editors[this.type].setValue(e,t),this.refreshValue(),o.onChange()},destroy:function(){l(this.editors,function(e,t){t&&t.destroy()}),this.editor_holder&&this.editor_holder.parentNode&&this.editor_holder.parentNode.removeChild(this.editor_holder),this.switcher&&this.switcher.parentNode&&this.switcher.parentNode.removeChild(this.switcher),this._super()},showValidationErrors:function(e){var t=this;if(this.oneOf||this.anyOf){var o=this.oneOf?'oneOf':'anyOf';l(this.editors,function(r,i){if(i){var n=t.path+'.'+o+'['+r+']',a=[];l(e,function(e,o){if(o.path.substr(0,n.length)===n){var r=s({},o);r.path=t.path+r.path.substr(n.length),a.push(r)}}),i.showValidationErrors(a)}})}else l(this.editors,function(t,o){o&&o.showValidationErrors(e)})}}),d.defaults.editors['enum']=d.AbstractEditor.extend({getNumColumns:function(){return 4},build:function(){this.container;this.title=this.header=this.label=this.theme.getFormInputLabel(this.getTitle()),this.container.appendChild(this.title),this.options.enum_titles=this.options.enum_titles||[],this['enum']=this.schema['enum'],this.selected=0,this.select_options=[],this.html_values=[];for(var e=this,t=0;t<this['enum'].length;t++)this.select_options[t]=this.options.enum_titles[t]||'Value '+(t+1),this.html_values[t]=this.getHTML(this['enum'][t]);this.switcher=this.theme.getSwitcher(this.select_options),this.container.appendChild(this.switcher),this.display_area=this.theme.getIndentedPanel(),this.container.appendChild(this.display_area),this.options.hide_display&&(this.display_area.style.display='none'),this.switcher.addEventListener('change',function(){e.selected=e.select_options.indexOf(this.value),e.value=e['enum'][e.selected],e.refreshValue(),e.onChange(!0)}),this.value=this['enum'][0],this.refreshValue(),1===this['enum'].length&&(this.switcher.style.display='none')},refreshValue:function(){var e=this;e.selected=-1;var t=JSON.stringify(this.value);return l(this['enum'],function(o,r){if(t===JSON.stringify(r))return e.selected=o,!1}),0>e.selected?void e.setValue(e['enum'][0]):void(this.switcher.value=this.select_options[this.selected],this.display_area.innerHTML=this.html_values[this.selected])},enable:function(){this.always_disabled||(this.switcher.disabled=!1),this._super()},disable:function(){this.switcher.disabled=!0,this._super()},getHTML:function(e){var t=this;if(null===e)return'<em>null</em>';if('object'==typeof e){var o='';return l(e,function(r,i){var n=t.getHTML(i);Array.isArray(e)||(n='<div><em>'+r+'</em>: '+n+'</div>'),o+='<li>'+n+'</li>'}),o=Array.isArray(e)?'<ol>'+o+'</ol>':'<ul style=\'margin-top:0;margin-bottom:0;padding-top:0;padding-bottom:0;\'>'+o+'</ul>',o}return'boolean'==typeof e?e?'true':'false':'string'==typeof e?e.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'):e},setValue:function(e){this.value!==e&&(this.value=e,this.refreshValue(),this.onChange())},destroy:function(){this.display_area&&this.display_area.parentNode&&this.display_area.parentNode.removeChild(this.display_area),this.title&&this.title.parentNode&&this.title.parentNode.removeChild(this.title),this.switcher&&this.switcher.parentNode&&this.switcher.parentNode.removeChild(this.switcher),this._super()}}),d.defaults.editors.select=d.AbstractEditor.extend({setValue:function(e){e=this.typecast(e||'');var t=e;0>this.enum_values.indexOf(t)&&(t=this.enum_values[0]);this.value===t||(this.input.value=this.enum_options[this.enum_values.indexOf(t)],this.select2&&this.select2.select2('val',this.input.value),this.value=t,this.onChange())},register:function(){this._super();this.input&&this.input.setAttribute('name',this.formname)},unregister:function(){this._super();this.input&&this.input.removeAttribute('name')},getNumColumns:function(){if(!this.enum_options)return 3;for(var e=this.getTitle().length,o=0;o<this.enum_options.length;o++)e=n(e,this.enum_options[o].length+4);return t(12,n(e/7,2))},typecast:function(e){return'boolean'===this.schema.type?!!e:'number'===this.schema.type?1*e:'integer'===this.schema.type?r(1*e):''+e},getValue:function(){return this.value},preBuild:function(){var e=this;this.input_type='select',this.enum_options=[],this.enum_values=[],this.enum_display=[];var t;if(this.schema['enum']){var o=this.schema.options&&this.schema.options.enum_titles||[];l(this.schema['enum'],function(t,r){e.enum_options[t]=''+r,e.enum_display[t]=''+(o[t]||r),e.enum_values[t]=e.typecast(r)}),this.isRequired()||(e.enum_display.unshift(' '),e.enum_options.unshift('undefined'),e.enum_values.unshift(void 0))}else if('boolean'===this.schema.type)e.enum_display=this.schema.options&&this.schema.options.enum_titles||['true','false'],e.enum_options=['1',''],e.enum_values=[!0,!1],this.isRequired()||(e.enum_display.unshift(' '),e.enum_options.unshift('undefined'),e.enum_values.unshift(void 0));else if(this.schema.enumSource){if(this.enumSource=[],this.enum_display=[],this.enum_options=[],this.enum_values=[],!Array.isArray(this.schema.enumSource))this.enumSource=this.schema.enumValue?[{source:this.schema.enumSource,value:this.schema.enumValue}]:[{source:this.schema.enumSource}];else for(t=0;t<this.schema.enumSource.length;t++)this.enumSource[t]='string'==typeof this.schema.enumSource[t]?{source:this.schema.enumSource[t]}:Array.isArray(this.schema.enumSource[t])?this.schema.enumSource[t]:s({},this.schema.enumSource[t]);for(t=0;t<this.enumSource.length;t++)this.enumSource[t].value&&(this.enumSource[t].value=this.jsoneditor.compileTemplate(this.enumSource[t].value,this.template_engine)),this.enumSource[t].title&&(this.enumSource[t].title=this.jsoneditor.compileTemplate(this.enumSource[t].title,this.template_engine)),this.enumSource[t].filter&&(this.enumSource[t].filter=this.jsoneditor.compileTemplate(this.enumSource[t].filter,this.template_engine))}else throw'\'select\' editor requires the enum property to be set.'},build:function(){var t=this;this.options.compact||(this.header=this.label=this.theme.getFormInputLabel(this.getTitle())),this.schema.description&&(this.description=this.theme.getFormInputDescription(this.schema.description)),this.options.compact&&(this.container.className+=' compact'),this.input=this.theme.getSelectInput(this.enum_options),this.theme.setSelectOptions(this.input,this.enum_options,this.enum_display),(this.schema.readOnly||this.schema.readonly)&&(this.always_disabled=!0,this.input.disabled=!0),this.input.addEventListener('change',function(o){o.preventDefault(),o.stopPropagation(),t.onInputChange()}),this.control=this.theme.getFormControl(this.label,this.input,this.description),this.container.appendChild(this.control),this.value=this.enum_values[0]},onInputChange:function(){var e,t=this.input.value;e=-1===this.enum_options.indexOf(t)?this.enum_values[0]:this.enum_values[this.enum_options.indexOf(t)];e===this.value||(this.value=e,this.onChange(!0))},setupSelect2:function(){if(window.jQuery&&window.jQuery.fn&&window.jQuery.fn.select2&&(2<this.enum_options.length||this.enum_options.length&&this.enumSource)){var e=s({},d.plugins.select2);this.schema.options&&this.schema.options.select2_options&&(e=s(e,this.schema.options.select2_options)),this.select2=window.jQuery(this.input).select2(e);var t=this;this.select2.on('select2-blur',function(){t.input.value=t.select2.select2('val'),t.onInputChange()}),this.select2.on('change',function(){t.input.value=t.select2.select2('val'),t.onInputChange()})}else this.select2=null},postBuild:function(){this._super(),this.theme.afterInputReady(this.input),this.setupSelect2()},onWatchedFieldChange:function(){var e,t,o=this;if(this.enumSource){e=this.getWatchedFieldValues();for(var r=[],n=[],a=0;a<this.enumSource.length;a++)if(Array.isArray(this.enumSource[a]))r=r.concat(this.enumSource[a]),n=n.concat(this.enumSource[a]);else{var i=[];if(i=Array.isArray(this.enumSource[a].source)?this.enumSource[a].source:e[this.enumSource[a].source],i){if(this.enumSource[a].slice&&(i=Array.prototype.slice.apply(i,this.enumSource[a].slice)),this.enumSource[a].filter){var s=[];for(t=0;t<i.length;t++)this.enumSource[a].filter({i:t,item:i[t],watched:e})&&s.push(i[t]);i=s}var l=[],d=[];for(t=0;t<i.length;t++){var p=i[t];d[t]=this.enumSource[a].value?this.enumSource[a].value({i:t,item:p}):i[t],l[t]=this.enumSource[a].title?this.enumSource[a].title({i:t,item:p}):d[t]}r=r.concat(d),n=n.concat(l)}}var c=this.value;this.theme.setSelectOptions(this.input,r,n),this.enum_options=r,this.enum_display=n,this.enum_values=r,this.select2&&this.select2.select2('destroy'),-1===r.indexOf(c)?(this.input.value=r[0],this.value=r[0]||'',this.parent?this.parent.onChildEditorChange(this):this.jsoneditor.onChange(),this.jsoneditor.notifyWatchers(this.path)):(this.input.value=c,this.value=c),this.setupSelect2()}this._super()},enable:function(){this.always_disabled||(this.input.disabled=!1,this.select2&&this.select2.select2('enable',!0)),this._super()},disable:function(){this.input.disabled=!0,this.select2&&this.select2.select2('enable',!1),this._super()},destroy:function(){this.label&&this.label.parentNode&&this.label.parentNode.removeChild(this.label),this.description&&this.description.parentNode&&this.description.parentNode.removeChild(this.description),this.input&&this.input.parentNode&&this.input.parentNode.removeChild(this.input),this.select2&&(this.select2.select2('destroy'),this.select2=null),this._super()}}),d.defaults.editors.selectize=d.AbstractEditor.extend({setValue:function(e){e=this.typecast(e||'');var t=e;0>this.enum_values.indexOf(t)&&(t=this.enum_values[0]);this.value===t||(this.input.value=this.enum_options[this.enum_values.indexOf(t)],this.selectize&&this.selectize[0].selectize.addItem(t),this.value=t,this.onChange())},register:function(){this._super();this.input&&this.input.setAttribute('name',this.formname)},unregister:function(){this._super();this.input&&this.input.removeAttribute('name')},getNumColumns:function(){if(!this.enum_options)return 3;for(var e=this.getTitle().length,o=0;o<this.enum_options.length;o++)e=n(e,this.enum_options[o].length+4);return t(12,n(e/7,2))},typecast:function(e){return'boolean'===this.schema.type?!!e:'number'===this.schema.type?1*e:'integer'===this.schema.type?r(1*e):''+e},getValue:function(){return this.value},preBuild:function(){var e=this;this.input_type='select',this.enum_options=[],this.enum_values=[],this.enum_display=[];var t;if(this.schema.enum){var o=this.schema.options&&this.schema.options.enum_titles||[];l(this.schema.enum,function(t,r){e.enum_options[t]=''+r,e.enum_display[t]=''+(o[t]||r),e.enum_values[t]=e.typecast(r)})}else if('boolean'===this.schema.type)e.enum_display=this.schema.options&&this.schema.options.enum_titles||['true','false'],e.enum_options=['1','0'],e.enum_values=[!0,!1];else if(this.schema.enumSource){if(this.enumSource=[],this.enum_display=[],this.enum_options=[],this.enum_values=[],!Array.isArray(this.schema.enumSource))this.enumSource=this.schema.enumValue?[{source:this.schema.enumSource,value:this.schema.enumValue}]:[{source:this.schema.enumSource}];else for(t=0;t<this.schema.enumSource.length;t++)this.enumSource[t]='string'==typeof this.schema.enumSource[t]?{source:this.schema.enumSource[t]}:Array.isArray(this.schema.enumSource[t])?this.schema.enumSource[t]:s({},this.schema.enumSource[t]);for(t=0;t<this.enumSource.length;t++)this.enumSource[t].value&&(this.enumSource[t].value=this.jsoneditor.compileTemplate(this.enumSource[t].value,this.template_engine)),this.enumSource[t].title&&(this.enumSource[t].title=this.jsoneditor.compileTemplate(this.enumSource[t].title,this.template_engine)),this.enumSource[t].filter&&(this.enumSource[t].filter=this.jsoneditor.compileTemplate(this.enumSource[t].filter,this.template_engine))}else throw'\'select\' editor requires the enum property to be set.'},build:function(){var t=this;this.options.compact||(this.header=this.label=this.theme.getFormInputLabel(this.getTitle())),this.schema.description&&(this.description=this.theme.getFormInputDescription(this.schema.description)),this.options.compact&&(this.container.className+=' compact'),this.input=this.theme.getSelectInput(this.enum_options),this.theme.setSelectOptions(this.input,this.enum_options,this.enum_display),(this.schema.readOnly||this.schema.readonly)&&(this.always_disabled=!0,this.input.disabled=!0),this.input.addEventListener('change',function(o){o.preventDefault(),o.stopPropagation(),t.onInputChange()}),this.control=this.theme.getFormControl(this.label,this.input,this.description),this.container.appendChild(this.control),this.value=this.enum_values[0]},onInputChange:function(){var e=this.input.value,t=e;-1===this.enum_options.indexOf(e)&&(t=this.enum_options[0]),this.value=this.enum_values[this.enum_options.indexOf(e)],this.onChange(!0)},setupSelectize:function(){var e=this;if(window.jQuery&&window.jQuery.fn&&window.jQuery.fn.selectize&&(2<=this.enum_options.length||this.enum_options.length&&this.enumSource)){var t=s({},d.plugins.selectize);this.schema.options&&this.schema.options.selectize_options&&(t=s(t,this.schema.options.selectize_options)),this.selectize=window.jQuery(this.input).selectize(s(t,{create:!0,onChange:function(){e.onInputChange()}}))}else this.selectize=null},postBuild:function(){this._super(),this.theme.afterInputReady(this.input),this.setupSelectize()},onWatchedFieldChange:function(){var e,t,o=this;if(this.enumSource){e=this.getWatchedFieldValues();for(var r=[],n=[],a=0;a<this.enumSource.length;a++)if(Array.isArray(this.enumSource[a]))r=r.concat(this.enumSource[a]),n=n.concat(this.enumSource[a]);else if(e[this.enumSource[a].source]){var i=e[this.enumSource[a].source];if(this.enumSource[a].slice&&(i=Array.prototype.slice.apply(i,this.enumSource[a].slice)),this.enumSource[a].filter){var s=[];for(t=0;t<i.length;t++)this.enumSource[a].filter({i:t,item:i[t]})&&s.push(i[t]);i=s}var l=[],d=[];for(t=0;t<i.length;t++){var p=i[t];d[t]=this.enumSource[a].value?this.enumSource[a].value({i:t,item:p}):i[t],l[t]=this.enumSource[a].title?this.enumSource[a].title({i:t,item:p}):d[t]}r=r.concat(d),n=n.concat(l)}var c=this.value;this.theme.setSelectOptions(this.input,r,n),this.enum_options=r,this.enum_display=n,this.enum_values=r,-1===r.indexOf(c)?(this.input.value=r[0],this.value=r[0]||'',this.parent?this.parent.onChildEditorChange(this):this.jsoneditor.onChange(),this.jsoneditor.notifyWatchers(this.path)):(this.input.value=c,this.value=c),this.selectize?this.updateSelectizeOptions(r):this.setupSelectize(),this._super()}},updateSelectizeOptions:function(e){var t=this.selectize[0].selectize,o=this;for(var r in t.off(),t.clearOptions(),e)t.addOption({value:e[r],text:e[r]});t.addItem(this.value),t.on('change',function(){o.onInputChange()})},enable:function(){this.always_disabled||(this.input.disabled=!1,this.selectize&&this.selectize[0].selectize.unlock()),this._super()},disable:function(){this.input.disabled=!0,this.selectize&&this.selectize[0].selectize.lock(),this._super()},destroy:function(){this.label&&this.label.parentNode&&this.label.parentNode.removeChild(this.label),this.description&&this.description.parentNode&&this.description.parentNode.removeChild(this.description),this.input&&this.input.parentNode&&this.input.parentNode.removeChild(this.input),this.selectize&&(this.selectize[0].selectize.destroy(),this.selectize=null),this._super()}}),d.defaults.editors.multiselect=d.AbstractEditor.extend({preBuild:function(){this._super();var o;this.select_options={},this.select_values={};var r=this.jsoneditor.expandRefs(this.schema.items||{}),i=r['enum']||[],e=r.options?r.options.enum_titles||[]:[];for(this.option_keys=[],this.option_titles=[],o=0;o<i.length;o++)this.sanitize(i[o])===i[o]&&(this.option_keys.push(i[o]+''),this.option_titles.push((e[o]||i[o])+''),this.select_values[i[o]+'']=i[o])},build:function(){var e,o=this;if(this.options.compact||(this.header=this.label=this.theme.getFormInputLabel(this.getTitle())),this.schema.description&&(this.description=this.theme.getFormInputDescription(this.schema.description)),!this.schema.format&&8>this.option_keys.length||'checkbox'===this.schema.format){for(this.input_type='checkboxes',this.inputs={},this.controls={},e=0;e<this.option_keys.length;e++){this.inputs[this.option_keys[e]]=this.theme.getCheckbox(),this.select_options[this.option_keys[e]]=this.inputs[this.option_keys[e]];var r=this.theme.getCheckboxLabel(this.option_titles[e]);this.controls[this.option_keys[e]]=this.theme.getFormControl(r,this.inputs[this.option_keys[e]])}this.control=this.theme.getMultiCheckboxHolder(this.controls,this.label,this.description)}else{for(this.input_type='select',this.input=this.theme.getSelectInput(this.option_keys),this.theme.setSelectOptions(this.input,this.option_keys,this.option_titles),this.input.multiple=!0,this.input.size=t(10,this.option_keys.length),e=0;e<this.option_keys.length;e++)this.select_options[this.option_keys[e]]=this.input.children[e];(this.schema.readOnly||this.schema.readonly)&&(this.always_disabled=!0,this.input.disabled=!0),this.control=this.theme.getFormControl(this.label,this.input,this.description)}this.container.appendChild(this.control),this.control.addEventListener('change',function(t){t.preventDefault(),t.stopPropagation();var r=[];for(e=0;e<o.option_keys.length;e++)(o.select_options[o.option_keys[e]].selected||o.select_options[o.option_keys[e]].checked)&&r.push(o.select_values[o.option_keys[e]]);o.updateValue(r),o.onChange(!0)})},setValue:function(e){for(e=e||[],'object'==typeof e?!Array.isArray(e)&&(e=[]):e=[e],t=0;t<e.length;t++)'string'!=typeof e[t]&&(e[t]+='');for(var t in this.select_options)this.select_options.hasOwnProperty(t)&&(this.select_options[t]['select'===this.input_type?'selected':'checked']=-1!==e.indexOf(t));this.updateValue(e),this.onChange()},setupSelect2:function(){if(window.jQuery&&window.jQuery.fn&&window.jQuery.fn.select2){var e=window.jQuery.extend({},d.plugins.select2);this.schema.options&&this.schema.options.select2_options&&(e=s(e,this.schema.options.select2_options)),this.select2=window.jQuery(this.input).select2(e);var t=this;this.select2.on('select2-blur',function(){var e=t.select2.select2('val');t.value=e,t.onChange(!0)})}else this.select2=null},onInputChange:function(){this.value=this.input.value,this.onChange(!0)},postBuild:function(){this._super(),this.setupSelect2()},register:function(){this._super();this.input&&this.input.setAttribute('name',this.formname)},unregister:function(){this._super();this.input&&this.input.removeAttribute('name')},getNumColumns:function(){var e=this.getTitle().length;for(var o in this.select_values)this.select_values.hasOwnProperty(o)&&(e=n(e,(this.select_values[o]+'').length+4));return t(12,n(e/7,2))},updateValue:function(e){for(var t=!1,o=[],r=0;r<e.length;r++){if(!this.select_options[e[r]+'']){t=!0;continue}var i=this.sanitize(this.select_values[e[r]]);o.push(i),i!==e[r]&&(t=!0)}return this.value=o,this.select2&&this.select2.select2('val',this.value),t},sanitize:function(e){return'number'===this.schema.items.type?1*e:'integer'===this.schema.items.type?r(1*e):''+e},enable:function(){if(!this.always_disabled){if(this.input)this.input.disabled=!1;else if(this.inputs)for(var e in this.inputs)this.inputs.hasOwnProperty(e)&&(this.inputs[e].disabled=!1);this.select2&&this.select2.select2('enable',!0)}this._super()},disable:function(){if(this.input)this.input.disabled=!0;else if(this.inputs)for(var e in this.inputs)this.inputs.hasOwnProperty(e)&&(this.inputs[e].disabled=!0);this.select2&&this.select2.select2('enable',!1),this._super()},destroy:function(){this.select2&&(this.select2.select2('destroy'),this.select2=null),this._super()}}),d.defaults.editors.base64=d.AbstractEditor.extend({getNumColumns:function(){return 4},build:function(){var e=this;if(this.title=this.header=this.label=this.theme.getFormInputLabel(this.getTitle()),this.input=this.theme.getFormInputField('hidden'),this.container.appendChild(this.input),!this.schema.readOnly&&!this.schema.readonly){if(!window.FileReader)throw'FileReader required for base64 editor';this.uploader=this.theme.getFormInputField('file'),this.uploader.addEventListener('change',function(t){if(t.preventDefault(),t.stopPropagation(),this.files&&this.files.length){var o=new FileReader;o.onload=function(t){e.value=t.target.result,e.refreshPreview(),e.onChange(!0),o=null},o.readAsDataURL(this.files[0])}})}this.preview=this.theme.getFormInputDescription(this.schema.description),this.container.appendChild(this.preview),this.control=this.theme.getFormControl(this.label,this.uploader||this.input,this.preview),this.container.appendChild(this.control)},refreshPreview:function(){if(this.last_preview!==this.value&&(this.last_preview=this.value,this.preview.innerHTML='',!!this.value)){var e=this.value.match(/^data:([^;,]+)[;,]/);if(e&&(e=e[1]),!e)this.preview.innerHTML='<em>Invalid data URI</em>';else if(this.preview.innerHTML='<strong>Type:</strong> '+e+', <strong>Size:</strong> '+r((this.value.length-this.value.split(',')[0].length-1)/1.33333)+' bytes','image'===e.substr(0,5)){this.preview.innerHTML+='<br>';var t=document.createElement('img');t.style.maxWidth='100%',t.style.maxHeight='100px',t.src=this.value,this.preview.appendChild(t)}}},enable:function(){this.uploader&&(this.uploader.disabled=!1),this._super()},disable:function(){this.uploader&&(this.uploader.disabled=!0),this._super()},setValue:function(e){this.value!==e&&(this.value=e,this.input.value=this.value,this.refreshPreview(),this.onChange())},destroy:function(){this.preview&&this.preview.parentNode&&this.preview.parentNode.removeChild(this.preview),this.title&&this.title.parentNode&&this.title.parentNode.removeChild(this.title),this.input&&this.input.parentNode&&this.input.parentNode.removeChild(this.input),this.uploader&&this.uploader.parentNode&&this.uploader.parentNode.removeChild(this.uploader),this._super()}}),d.defaults.editors.upload=d.AbstractEditor.extend({getNumColumns:function(){return 4},build:function(){var e=this;if(this.title=this.header=this.label=this.theme.getFormInputLabel(this.getTitle()),this.input=this.theme.getFormInputField('hidden'),this.container.appendChild(this.input),!this.schema.readOnly&&!this.schema.readonly){if(!this.jsoneditor.options.upload)throw'Upload handler required for upload editor';this.uploader=this.theme.getFormInputField('file'),this.uploader.addEventListener('change',function(t){if(t.preventDefault(),t.stopPropagation(),this.files&&this.files.length){var o=new FileReader;o.onload=function(t){e.preview_value=t.target.result,e.refreshPreview(),e.onChange(!0),o=null},o.readAsDataURL(this.files[0])}})}var t=this.schema.description;t||(t=''),this.preview=this.theme.getFormInputDescription(t),this.container.appendChild(this.preview),this.control=this.theme.getFormControl(this.label,this.uploader||this.input,this.preview),this.container.appendChild(this.control)},refreshPreview:function(){if(this.last_preview!==this.preview_value&&(this.last_preview=this.preview_value,this.preview.innerHTML='',!!this.preview_value)){var e=this,t=this.preview_value.match(/^data:([^;,]+)[;,]/);t&&(t=t[1]),t||(t='unknown');var o=this.uploader.files[0];if(this.preview.innerHTML='<strong>Type:</strong> '+t+', <strong>Size:</strong> '+o.size+' bytes','image'===t.substr(0,5)){this.preview.innerHTML+='<br>';var r=document.createElement('img');r.style.maxWidth='100%',r.style.maxHeight='100px',r.src=this.preview_value,this.preview.appendChild(r)}this.preview.innerHTML+='<br>';var i=this.getButton('Upload','upload','Upload');this.preview.appendChild(i),i.addEventListener('click',function(t){t.preventDefault(),i.setAttribute('disabled','disabled'),e.theme.removeInputError(e.uploader),e.theme.getProgressBar&&(e.progressBar=e.theme.getProgressBar(),e.preview.appendChild(e.progressBar)),e.jsoneditor.options.upload(e.path,o,{success:function(t){e.setValue(t),e.parent?e.parent.onChildEditorChange(e):e.jsoneditor.onChange(),e.progressBar&&e.preview.removeChild(e.progressBar),i.removeAttribute('disabled')},failure:function(t){e.theme.addInputError(e.uploader,t),e.progressBar&&e.preview.removeChild(e.progressBar),i.removeAttribute('disabled')},updateProgress:function(t){e.progressBar&&(t?e.theme.updateProgressBar(e.progressBar,t):e.theme.updateProgressBarUnknown(e.progressBar))}})})}},enable:function(){this.uploader&&(this.uploader.disabled=!1),this._super()},disable:function(){this.uploader&&(this.uploader.disabled=!0),this._super()},setValue:function(e){this.value!==e&&(this.value=e,this.input.value=this.value,this.onChange())},destroy:function(){this.preview&&this.preview.parentNode&&this.preview.parentNode.removeChild(this.preview),this.title&&this.title.parentNode&&this.title.parentNode.removeChild(this.title),this.input&&this.input.parentNode&&this.input.parentNode.removeChild(this.input),this.uploader&&this.uploader.parentNode&&this.uploader.parentNode.removeChild(this.uploader),this._super()}}),d.defaults.editors.checkbox=d.AbstractEditor.extend({setValue:function(e){this.value=!!e,this.input.checked=this.value,this.onChange()},register:function(){this._super();this.input&&this.input.setAttribute('name',this.formname)},unregister:function(){this._super();this.input&&this.input.removeAttribute('name')},getNumColumns:function(){return t(12,n(this.getTitle().length/7,2))},build:function(){var t=this;this.options.compact||(this.label=this.header=this.theme.getCheckboxLabel(this.getTitle())),this.schema.description&&(this.description=this.theme.getFormInputDescription(this.schema.description)),this.options.compact&&(this.container.className+=' compact'),this.input=this.theme.getCheckbox(),this.control=this.theme.getFormControl(this.label,this.input,this.description),(this.schema.readOnly||this.schema.readonly)&&(this.always_disabled=!0,this.input.disabled=!0),this.input.addEventListener('change',function(o){o.preventDefault(),o.stopPropagation(),t.value=this.checked,t.onChange(!0)}),this.container.appendChild(this.control)},enable:function(){this.always_disabled||(this.input.disabled=!1),this._super()},disable:function(){this.input.disabled=!0,this._super()},destroy:function(){this.label&&this.label.parentNode&&this.label.parentNode.removeChild(this.label),this.description&&this.description.parentNode&&this.description.parentNode.removeChild(this.description),this.input&&this.input.parentNode&&this.input.parentNode.removeChild(this.input),this._super()}}),d.defaults.editors.arraySelectize=d.AbstractEditor.extend({build:function(){this.title=this.theme.getFormInputLabel(this.getTitle()),this.title_controls=this.theme.getHeaderButtonHolder(),this.title.appendChild(this.title_controls),this.error_holder=document.createElement('div'),this.schema.description&&(this.description=this.theme.getDescription(this.schema.description)),this.input=document.createElement('select'),this.input.setAttribute('multiple','multiple');var e=this.theme.getFormControl(this.title,this.input,this.description);this.container.appendChild(e),this.container.appendChild(this.error_holder),window.jQuery(this.input).selectize({delimiter:!1,createOnBlur:!0,create:!0})},postBuild:function(){var e=this;this.input.selectize.on('change',function(){e.refreshValue(),e.onChange(!0)})},destroy:function(){this.empty(!0),this.title&&this.title.parentNode&&this.title.parentNode.removeChild(this.title),this.description&&this.description.parentNode&&this.description.parentNode.removeChild(this.description),this.input&&this.input.parentNode&&this.input.parentNode.removeChild(this.input),this._super()},empty:function(){},setValue:function(e,t){var o=this;e=e||[],Array.isArray(e)||(e=[e]),this.input.selectize.clearOptions(),this.input.selectize.clear(!0),e.forEach(function(e){o.input.selectize.addOption({text:e,value:e})}),this.input.selectize.setValue(e),this.refreshValue(t)},refreshValue:function(){this.value=this.input.selectize.getValue()},showValidationErrors:function(e){var t=this,o=[],r=[];if(l(e,function(e,i){i.path===t.path?o.push(i):r.push(i)}),this.error_holder)if(o.length){this.error_holder.innerHTML='',this.error_holder.style.display='',l(o,function(e,o){t.error_holder.appendChild(t.theme.getErrorMessage(o.message))})}else this.error_holder.style.display='none'}});var p=function(){var e=document.documentElement;if(e.matches)return'matches';return e.webkitMatchesSelector?'webkitMatchesSelector':e.mozMatchesSelector?'mozMatchesSelector':e.msMatchesSelector?'msMatchesSelector':e.oMatchesSelector?'oMatchesSelector':void 0}();d.AbstractTheme=e.extend({getContainer:function(){return document.createElement('div')},getFloatRightLinkHolder:function(){var e=document.createElement('div');return e.style=e.style||{},e.style.cssFloat='right',e.style.marginLeft='10px',e},getModal:function(){var e=document.createElement('div');return e.style.backgroundColor='white',e.style.border='1px solid black',e.style.boxShadow='3px 3px black',e.style.position='absolute',e.style.zIndex='10',e.style.display='none',e},getGridContainer:function(){var e=document.createElement('div');return e},getGridRow:function(){var e=document.createElement('div');return e.className='row',e},getGridColumn:function(){var e=document.createElement('div');return e},setGridColumnSize:function(){},getLink:function(e){var t=document.createElement('a');return t.setAttribute('href','#'),t.appendChild(document.createTextNode(e)),t},disableHeader:function(e){e.style.color='#ccc'},disableLabel:function(e){e.style.color='#ccc'},enableHeader:function(e){e.style.color=''},enableLabel:function(e){e.style.color=''},getFormInputLabel:function(e){var t=document.createElement('label');return t.appendChild(document.createTextNode(e)),t},getCheckboxLabel:function(e){var t=this.getFormInputLabel(e);return t.style.fontWeight='normal',t},getHeader:function(e){var t=document.createElement('h3');return'string'==typeof e?t.textContent=e:t.appendChild(e),t},getCheckbox:function(){var e=this.getFormInputField('checkbox');return e.style.display='inline-block',e.style.width='auto',e},getMultiCheckboxHolder:function(e,t,o){var r=document.createElement('div');for(var n in t&&(t.style.display='block',r.appendChild(t)),e)e.hasOwnProperty(n)&&(e[n].style.display='inline-block',e[n].style.marginRight='20px',r.appendChild(e[n]));return o&&r.appendChild(o),r},getSelectInput:function(e){var t=document.createElement('select');return e&&this.setSelectOptions(t,e),t},getSwitcher:function(e){var t=this.getSelectInput(e);return t.style.backgroundColor='transparent',t.style.display='inline-block',t.style.fontStyle='italic',t.style.fontWeight='normal',t.style.height='auto',t.style.marginBottom=0,t.style.marginLeft='5px',t.style.padding='0 0 0 3px',t.style.width='auto',t},getSwitcherOptions:function(e){return e.getElementsByTagName('option')},setSwitcherOptions:function(e,t,o){this.setSelectOptions(e,t,o)},setSelectOptions:function(e,t,o){o=o||[],e.innerHTML='';for(var r,n=0;n<t.length;n++)r=document.createElement('option'),r.setAttribute('value',t[n]),r.textContent=o[n]||t[n],e.appendChild(r)},getTextareaInput:function(){var e=document.createElement('textarea');return e.style=e.style||{},e.style.width='100%',e.style.height='300px',e.style.boxSizing='border-box',e},getRangeInput:function(e,t,o){var r=this.getFormInputField('range');return r.setAttribute('min',e),r.setAttribute('max',t),r.setAttribute('step',o),r},getFormInputField:function(e){var t=document.createElement('input');return t.setAttribute('type',e),t},afterInputReady:function(){},getFormControl:function(e,t,o){var r=document.createElement('div');return r.className='form-control',e&&r.appendChild(e),'checkbox'===t.type?e.insertBefore(t,e.firstChild):r.appendChild(t),o&&r.appendChild(o),r},getIndentedPanel:function(){var e=document.createElement('div');return e.style=e.style||{},e.style.paddingLeft='10px',e.style.marginLeft='10px',e.style.borderLeft='1px solid #ccc',e},getChildEditorHolder:function(){return document.createElement('div')},getDescription:function(e){var t=document.createElement('p');return t.innerHTML=e,t},getCheckboxDescription:function(e){return this.getDescription(e)},getFormInputDescription:function(e){return this.getDescription(e)},getHeaderButtonHolder:function(){return this.getButtonHolder()},getButtonHolder:function(){return document.createElement('div')},getButton:function(e,t,o){var r=document.createElement('button');return r.type='button',this.setButtonText(r,e,t,o),r},setButtonText:function(e,t,o,r){e.innerHTML='',o&&(e.appendChild(o),e.innerHTML+=' '),e.appendChild(document.createTextNode(t)),r&&e.setAttribute('title',r)},getTable:function(){return document.createElement('table')},getTableRow:function(){return document.createElement('tr')},getTableHead:function(){return document.createElement('thead')},getTableBody:function(){return document.createElement('tbody')},getTableHeaderCell:function(e){var t=document.createElement('th');return t.textContent=e,t},getTableCell:function(){var e=document.createElement('td');return e},getErrorMessage:function(e){var t=document.createElement('p');return t.style=t.style||{},t.style.color='red',t.appendChild(document.createTextNode(e)),t},addInputError:function(){},removeInputError:function(){},addTableRowError:function(){},removeTableRowError:function(){},getTabHolder:function(){var e=document.createElement('div');return e.innerHTML='<div style=\'float: left; width: 130px;\' class=\'tabs\'></div><div class=\'content\' style=\'margin-left: 130px;\'></div><div style=\'clear:both;\'></div>',e},applyStyles:function(e,t){for(var o in e.style=e.style||{},t)t.hasOwnProperty(o)&&(e.style[o]=t[o])},closest:function(e,t){for(;e&&e!==document;)if(e[p]){if(e[p](t))return e;e=e.parentNode}else return!1;return!1},getTab:function(e){var t=document.createElement('div');return t.appendChild(e),t.style=t.style||{},this.applyStyles(t,{border:'1px solid #ccc',borderWidth:'1px 0 1px 1px',textAlign:'center',lineHeight:'30px',borderRadius:'5px',borderBottomRightRadius:0,borderTopRightRadius:0,fontWeight:'bold',cursor:'pointer'}),t},getTabContentHolder:function(e){return e.children[1]},getTabContent:function(){return this.getIndentedPanel()},markTabActive:function(e){this.applyStyles(e,{opacity:1,background:'white'})},markTabInactive:function(e){this.applyStyles(e,{opacity:0.5,background:''})},addTab:function(e,t){e.children[0].appendChild(t)},getBlockLink:function(){var e=document.createElement('a');return e.style.display='block',e},getBlockLinkHolder:function(){var e=document.createElement('div');return e},getLinksHolder:function(){var e=document.createElement('div');return e},createMediaLink:function(e,t,o){e.appendChild(t),o.style.width='100%',e.appendChild(o)},createImageLink:function(e,t,o){e.appendChild(t),t.appendChild(o)}}),d.defaults.themes.bootstrap2=d.AbstractTheme.extend({getRangeInput:function(e,t,o){return this._super(e,t,o)},getGridContainer:function(){var e=document.createElement('div');return e.className='container-fluid',e},getGridRow:function(){var e=document.createElement('div');return e.className='row-fluid',e},getFormInputLabel:function(e){var t=this._super(e);return t.style.display='inline-block',t.style.fontWeight='bold',t},setGridColumnSize:function(e,t){e.className='span'+t},getSelectInput:function(e){var t=this._super(e);return t.style.width='auto',t.style.maxWidth='98%',t},getFormInputField:function(e){var t=this._super(e);return t.style.width='98%',t},afterInputReady:function(e){e.controlgroup||(e.controlgroup=this.closest(e,'.control-group'),e.controls=this.closest(e,'.controls'),this.closest(e,'.compact')&&(e.controlgroup.className=e.controlgroup.className.replace(/control-group/g,'').replace(/[ ]{2,}/g,' '),e.controls.className=e.controlgroup.className.replace(/controls/g,'').replace(/[ ]{2,}/g,' '),e.style.marginBottom=0))},getIndentedPanel:function(){var e=document.createElement('div');return e.className='well well-small',e.style.paddingBottom=0,e},getFormInputDescription:function(e){var t=document.createElement('p');return t.className='help-inline',t.textContent=e,t},getFormControl:function(e,t,o){var r=document.createElement('div');r.className='control-group';var i=document.createElement('div');return i.className='controls',e&&'checkbox'===t.getAttribute('type')?(r.appendChild(i),e.className+=' checkbox',e.appendChild(t),i.appendChild(e),i.style.height='30px'):(e&&(e.className+=' control-label',r.appendChild(e)),i.appendChild(t),r.appendChild(i)),o&&i.appendChild(o),r},getHeaderButtonHolder:function(){var e=this.getButtonHolder();return e.style.marginLeft='10px',e},getButtonHolder:function(){var e=document.createElement('div');return e.className='btn-group',e},getButton:function(e,t,o){var r=this._super(e,t,o);return r.className+=' btn btn-default',r},getTable:function(){var e=document.createElement('table');return e.className='table table-bordered',e.style.width='auto',e.style.maxWidth='none',e},addInputError:function(e,t){e.controlgroup&&e.controls&&(e.controlgroup.className+=' error',e.errmsg?e.errmsg.style.display='':(e.errmsg=document.createElement('p'),e.errmsg.className='help-block errormsg',e.controls.appendChild(e.errmsg)),e.errmsg.textContent=t)},removeInputError:function(e){e.errmsg&&(e.errmsg.style.display='none',e.controlgroup.className=e.controlgroup.className.replace(/\s?error/g,''))},getTabHolder:function(){var e=document.createElement('div');return e.className='tabbable tabs-left',e.innerHTML='<ul class=\'nav nav-tabs span2\' style=\'margin-right: 0;\'></ul><div class=\'tab-content span10\' style=\'overflow:visible;\'></div>',e},getTab:function(e){var t=document.createElement('li'),o=document.createElement('a');return o.setAttribute('href','#'),o.appendChild(e),t.appendChild(o),t},getTabContentHolder:function(e){return e.children[1]},getTabContent:function(){var e=document.createElement('div');return e.className='tab-pane active',e},markTabActive:function(e){e.className+=' active'},markTabInactive:function(e){e.className=e.className.replace(/\s?active/g,'')},addTab:function(e,t){e.children[0].appendChild(t)},getProgressBar:function(){var e=document.createElement('div');e.className='progress';var t=document.createElement('div');return t.className='bar',t.style.width='0%',e.appendChild(t),e},updateProgressBar:function(e,t){e&&(e.firstChild.style.width=t+'%')},updateProgressBarUnknown:function(e){e&&(e.className='progress progress-striped active',e.firstChild.style.width='100%')}}),d.defaults.themes.bootstrap3=d.AbstractTheme.extend({getSelectInput:function(e){var t=this._super(e);return t.className+='form-control',t},setGridColumnSize:function(e,t){e.className='col-md-'+t},afterInputReady:function(e){e.controlgroup||(e.controlgroup=this.closest(e,'.form-group'),this.closest(e,'.compact')&&(e.controlgroup.style.marginBottom=0))},getTextareaInput:function(){var e=document.createElement('textarea');return e.className='form-control',e},getRangeInput:function(e,t,o){return this._super(e,t,o)},getFormInputField:function(e){var t=this._super(e);return'checkbox'!==e&&(t.className+='form-control'),t},getFormControl:function(e,t,o){var r=document.createElement('div');return e&&'checkbox'===t.type?(r.className+=' checkbox',e.appendChild(t),e.style.fontSize='14px',r.style.marginTop='0',r.appendChild(e),t.style.position='relative',t.style.cssFloat='left'):(r.className+=' form-group',e&&(e.className+=' control-label',r.appendChild(e)),r.appendChild(t)),o&&r.appendChild(o),r},getIndentedPanel:function(){var e=document.createElement('div');return e.className='well well-sm',e.style.paddingBottom=0,e},getFormInputDescription:function(e){var t=document.createElement('p');return t.className='help-block',t.innerHTML=e,t},getHeaderButtonHolder:function(){var e=this.getButtonHolder();return e.style.marginLeft='10px',e},getButtonHolder:function(){var e=document.createElement('div');return e.className='btn-group',e},getButton:function(e,t,o){var r=this._super(e,t,o);return r.className+='btn btn-default',r},getTable:function(){var e=document.createElement('table');return e.className='table table-bordered',e.style.width='auto',e.style.maxWidth='none',e},addInputError:function(e,t){e.controlgroup&&(e.controlgroup.className+=' has-error',e.errmsg?e.errmsg.style.display='':(e.errmsg=document.createElement('p'),e.errmsg.className='help-block errormsg',e.controlgroup.appendChild(e.errmsg)),e.errmsg.textContent=t)},removeInputError:function(e){e.errmsg&&(e.errmsg.style.display='none',e.controlgroup.className=e.controlgroup.className.replace(/\s?has-error/g,''))},getTabHolder:function(){var e=document.createElement('div');return e.innerHTML='<div class=\'tabs list-group col-md-2\'></div><div class=\'col-md-10\'></div>',e.className='rows',e},getTab:function(e){var t=document.createElement('a');return t.className='list-group-item',t.setAttribute('href','#'),t.appendChild(e),t},markTabActive:function(e){e.className+=' active'},markTabInactive:function(e){e.className=e.className.replace(/\s?active/g,'')},getProgressBar:function(){var e=0,t=document.createElement('div');t.className='progress';var o=document.createElement('div');return o.className='progress-bar',o.setAttribute('role','progressbar'),o.setAttribute('aria-valuenow',e),o.setAttribute('aria-valuemin',0),o.setAttribute('aria-valuenax',100),o.innerHTML=e+'%',t.appendChild(o),t},updateProgressBar:function(e,t){if(e){var o=e.firstChild,r=t+'%';o.setAttribute('aria-valuenow',t),o.style.width=r,o.innerHTML=r}},updateProgressBarUnknown:function(e){if(e){var t=e.firstChild;e.className='progress progress-striped active',t.removeAttribute('aria-valuenow'),t.style.width='100%',t.innerHTML=''}}}),d.defaults.themes.foundation=d.AbstractTheme.extend({getChildEditorHolder:function(){var e=document.createElement('div');return e.style.marginBottom='15px',e},getSelectInput:function(e){var t=this._super(e);return t.style.minWidth='none',t.style.padding='5px',t.style.marginTop='3px',t},getSwitcher:function(e){var t=this._super(e);return t.style.paddingRight='8px',t},afterInputReady:function(e){this.closest(e,'.compact')&&(e.style.marginBottom=0),e.group=this.closest(e,'.form-control')},getFormInputLabel:function(e){var t=this._super(e);return t.style.display='inline-block',t},getFormInputField:function(e){var t=this._super(e);return t.style.width='100%',t.style.marginBottom='checkbox'===e?'0':'12px',t},getFormInputDescription:function(e){var t=document.createElement('p');return t.textContent=e,t.style.marginTop='-10px',t.style.fontStyle='italic',t},getIndentedPanel:function(){var e=document.createElement('div');return e.className='panel',e.style.paddingBottom=0,e},getHeaderButtonHolder:function(){var e=this.getButtonHolder();return e.style.display='inline-block',e.style.marginLeft='10px',e.style.verticalAlign='middle',e},getButtonHolder:function(){var e=document.createElement('div');return e.className='button-group',e},getButton:function(e,t,o){var r=this._super(e,t,o);return r.className+=' small button',r},addInputError:function(e,t){e.group&&(e.group.className+=' error',e.errmsg?e.errmsg.style.display='':(e.insertAdjacentHTML('afterend','<small class="error"></small>'),e.errmsg=e.parentNode.getElementsByClassName('error')[0]),e.errmsg.textContent=t)},removeInputError:function(e){e.errmsg&&(e.group.className=e.group.className.replace(/ error/g,''),e.errmsg.style.display='none')},getProgressBar:function(){var e=document.createElement('div');e.className='progress';var t=document.createElement('span');return t.className='meter',t.style.width='0%',e.appendChild(t),e},updateProgressBar:function(e,t){e&&(e.firstChild.style.width=t+'%')},updateProgressBarUnknown:function(e){e&&(e.firstChild.style.width='100%')}}),d.defaults.themes.foundation3=d.defaults.themes.foundation.extend({getHeaderButtonHolder:function(){var e=this._super();return e.style.fontSize='.6em',e},getFormInputLabel:function(e){var t=this._super(e);return t.style.fontWeight='bold',t},getTabHolder:function(){var e=document.createElement('div');return e.className='row',e.innerHTML='<dl class=\'tabs vertical two columns\'></dl><div class=\'tabs-content ten columns\'></div>',e},setGridColumnSize:function(e,t){e.className='columns '+['zero','one','two','three','four','five','six','seven','eight','nine','ten','eleven','twelve'][t]},getTab:function(e){var t=document.createElement('dd'),o=document.createElement('a');return o.setAttribute('href','#'),o.appendChild(e),t.appendChild(o),t},getTabContentHolder:function(e){return e.children[1]},getTabContent:function(){var e=document.createElement('div');return e.className='content active',e.style.paddingLeft='5px',e},markTabActive:function(e){e.className+=' active'},markTabInactive:function(e){e.className=e.className.replace(/\s*active/g,'')},addTab:function(e,t){e.children[0].appendChild(t)}}),d.defaults.themes.foundation4=d.defaults.themes.foundation.extend({getHeaderButtonHolder:function(){var e=this._super();return e.style.fontSize='.6em',e},setGridColumnSize:function(e,t){e.className='columns large-'+t},getFormInputDescription:function(e){var t=this._super(e);return t.style.fontSize='.8rem',t},getFormInputLabel:function(e){var t=this._super(e);return t.style.fontWeight='bold',t}}),d.defaults.themes.foundation5=d.defaults.themes.foundation.extend({getFormInputDescription:function(e){var t=this._super(e);return t.style.fontSize='.8rem',t},setGridColumnSize:function(e,t){e.className='columns medium-'+t},getButton:function(e,t,o){var r=this._super(e,t,o);return r.className=r.className.replace(/\s*small/g,'')+' tiny',r},getTabHolder:function(){var e=document.createElement('div');return e.innerHTML='<dl class=\'tabs vertical\'></dl><div class=\'tabs-content vertical\'></div>',e},getTab:function(e){var t=document.createElement('dd'),o=document.createElement('a');return o.setAttribute('href','#'),o.appendChild(e),t.appendChild(o),t},getTabContentHolder:function(e){return e.children[1]},getTabContent:function(){var e=document.createElement('div');return e.className='content active',e.style.paddingLeft='5px',e},markTabActive:function(e){e.className+=' active'},markTabInactive:function(e){e.className=e.className.replace(/\s*active/g,'')},addTab:function(e,t){e.children[0].appendChild(t)}}),d.defaults.themes.foundation6=d.defaults.themes.foundation5.extend({getIndentedPanel:function(){var e=document.createElement('div');return e.className='callout secondary',e},getButtonHolder:function(){var e=document.createElement('div');return e.className='button-group tiny',e.style.marginBottom=0,e},getFormInputLabel:function(e){var t=this._super(e);return t.style.display='block',t},getFormControl:function(e,t,o){var r=document.createElement('div');return r.className='form-control',e&&r.appendChild(e),'checkbox'===t.type?e.insertBefore(t,e.firstChild):e?e.appendChild(t):r.appendChild(t),o&&e.appendChild(o),r},addInputError:function(e,t){if(e.group){if(e.group.className+=' error',!e.errmsg){var o=document.createElement('span');o.className='form-error is-visible',e.group.getElementsByTagName('label')[0].appendChild(o),e.className+=' is-invalid-input',e.errmsg=o}else e.errmsg.style.display='',e.className='';e.errmsg.textContent=t}},removeInputError:function(e){e.errmsg&&(e.className=e.className.replace(/ is-invalid-input/g,''),e.errmsg.parentNode&&e.errmsg.parentNode.removeChild(e.errmsg))}}),d.defaults.themes.html=d.AbstractTheme.extend({getFormInputLabel:function(e){var t=this._super(e);return t.style.display='block',t.style.marginBottom='3px',t.style.fontWeight='bold',t},getFormInputDescription:function(e){var t=this._super(e);return t.style.fontSize='.8em',t.style.margin=0,t.style.display='inline-block',t.style.fontStyle='italic',t},getIndentedPanel:function(){var e=this._super();return e.style.border='1px solid #ddd',e.style.padding='5px',e.style.margin='5px',e.style.borderRadius='3px',e},getChildEditorHolder:function(){var e=this._super();return e.style.marginBottom='8px',e},getHeaderButtonHolder:function(){var e=this.getButtonHolder();return e.style.display='inline-block',e.style.marginLeft='10px',e.style.fontSize='.8em',e.style.verticalAlign='middle',e},getTable:function(){var e=this._super();return e.style.borderBottom='1px solid #ccc',e.style.marginBottom='5px',e},addInputError:function(e,t){if(e.style.borderColor='red',!e.errmsg){var o=this.closest(e,'.form-control');e.errmsg=document.createElement('div'),e.errmsg.setAttribute('class','errmsg'),e.errmsg.style=e.errmsg.style||{},e.errmsg.style.color='red',o.appendChild(e.errmsg)}else e.errmsg.style.display='block';e.errmsg.innerHTML='',e.errmsg.appendChild(document.createTextNode(t))},removeInputError:function(e){e.style.borderColor='',e.errmsg&&(e.errmsg.style.display='none')},getProgressBar:function(){var e=document.createElement('progress');return e.setAttribute('max',100),e.setAttribute('value',0),e},updateProgressBar:function(e,t){e&&e.setAttribute('value',t)},updateProgressBarUnknown:function(e){e&&e.removeAttribute('value')}}),d.defaults.themes.jqueryui=d.AbstractTheme.extend({getTable:function(){var e=this._super();return e.setAttribute('cellpadding',5),e.setAttribute('cellspacing',0),e},getTableHeaderCell:function(e){var t=this._super(e);return t.className='ui-state-active',t.style.fontWeight='bold',t},getTableCell:function(){var e=this._super();return e.className='ui-widget-content',e},getHeaderButtonHolder:function(){var e=this.getButtonHolder();return e.style.marginLeft='10px',e.style.fontSize='.6em',e.style.display='inline-block',e},getFormInputDescription:function(e){var t=this.getDescription(e);return t.style.marginLeft='10px',t.style.display='inline-block',t},getFormControl:function(e,t,o){var r=this._super(e,t,o);return'checkbox'===t.type?(r.style.lineHeight='25px',r.style.padding='3px 0'):r.style.padding='4px 0 8px 0',r},getDescription:function(e){var t=document.createElement('span');return t.style.fontSize='.8em',t.style.fontStyle='italic',t.textContent=e,t},getButtonHolder:function(){var e=document.createElement('div');return e.className='ui-buttonset',e.style.fontSize='.7em',e},getFormInputLabel:function(e){var t=document.createElement('label');return t.style.fontWeight='bold',t.style.display='block',t.textContent=e,t},getButton:function(e,t,o){var r=document.createElement('button');r.className='ui-button ui-widget ui-state-default ui-corner-all',t&&!e?(r.className+=' ui-button-icon-only',t.className+=' ui-button-icon-primary ui-icon-primary',r.appendChild(t)):t?(r.className+=' ui-button-text-icon-primary',t.className+=' ui-button-icon-primary ui-icon-primary',r.appendChild(t)):r.className+=' ui-button-text-only';var i=document.createElement('span');return i.className='ui-button-text',i.textContent=e||o||'.',r.appendChild(i),r.setAttribute('title',o),r},setButtonText:function(e,t,o,r){e.innerHTML='',e.className='ui-button ui-widget ui-state-default ui-corner-all',o&&!t?(e.className+=' ui-button-icon-only',o.className+=' ui-button-icon-primary ui-icon-primary',e.appendChild(o)):o?(e.className+=' ui-button-text-icon-primary',o.className+=' ui-button-icon-primary ui-icon-primary',e.appendChild(o)):e.className+=' ui-button-text-only';var i=document.createElement('span');i.className='ui-button-text',i.textContent=t||r||'.',e.appendChild(i),e.setAttribute('title',r)},getIndentedPanel:function(){var e=document.createElement('div');return e.className='ui-widget-content ui-corner-all',e.style.padding='1em 1.4em',e.style.marginBottom='20px',e},afterInputReady:function(e){e.controls||(e.controls=this.closest(e,'.form-control'))},addInputError:function(e,t){e.controls&&(e.errmsg?e.errmsg.style.display='':(e.errmsg=document.createElement('div'),e.errmsg.className='ui-state-error',e.controls.appendChild(e.errmsg)),e.errmsg.textContent=t)},removeInputError:function(e){e.errmsg&&(e.errmsg.style.display='none')},markTabActive:function(e){e.className=e.className.replace(/\s*ui-widget-header/g,'')+' ui-state-active'},markTabInactive:function(e){e.className=e.className.replace(/\s*ui-state-active/g,'')+' ui-widget-header'}}),d.defaults.themes.barebones=d.AbstractTheme.extend({getFormInputLabel:function(e){var t=this._super(e);return t},getFormInputDescription:function(e){var t=this._super(e);return t},getIndentedPanel:function(){var e=this._super();return e},getChildEditorHolder:function(){var e=this._super();return e},getHeaderButtonHolder:function(){var e=this.getButtonHolder();return e},getTable:function(){var e=this._super();return e},addInputError:function(e,t){if(!e.errmsg){var o=this.closest(e,'.form-control');e.errmsg=document.createElement('div'),e.errmsg.setAttribute('class','errmsg'),o.appendChild(e.errmsg)}else e.errmsg.style.display='block';e.errmsg.innerHTML='',e.errmsg.appendChild(document.createTextNode(t))},removeInputError:function(e){e.style.borderColor='',e.errmsg&&(e.errmsg.style.display='none')},getProgressBar:function(){var e=document.createElement('progress');return e.setAttribute('max',100),e.setAttribute('value',0),e},updateProgressBar:function(e,t){e&&e.setAttribute('value',t)},updateProgressBarUnknown:function(e){e&&e.removeAttribute('value')}}),d.AbstractIconLib=e.extend({mapping:{collapse:'',expand:'',delete:'',edit:'',add:'',cancel:'',save:'',moveup:'',movedown:''},icon_prefix:'',getIconClass:function(e){return this.mapping[e]?this.icon_prefix+this.mapping[e]:null},getIcon:function(e){var t=this.getIconClass(e);if(!t)return null;var o=document.createElement('i');return o.className=t,o}}),d.defaults.iconlibs.bootstrap2=d.AbstractIconLib.extend({mapping:{collapse:'chevron-down',expand:'chevron-up',delete:'trash',edit:'pencil',add:'plus',cancel:'ban-circle',save:'ok',moveup:'arrow-up',movedown:'arrow-down'},icon_prefix:'icon-'}),d.defaults.iconlibs.bootstrap3=d.AbstractIconLib.extend({mapping:{collapse:'chevron-down',expand:'chevron-right',delete:'remove',edit:'pencil',add:'plus',cancel:'floppy-remove',save:'floppy-saved',moveup:'arrow-up',movedown:'arrow-down'},icon_prefix:'glyphicon glyphicon-'}),d.defaults.iconlibs.fontawesome3=d.AbstractIconLib.extend({mapping:{collapse:'chevron-down',expand:'chevron-right',delete:'remove',edit:'pencil',add:'plus',cancel:'ban-circle',save:'save',moveup:'arrow-up',movedown:'arrow-down'},icon_prefix:'icon-'}),d.defaults.iconlibs.fontawesome4=d.AbstractIconLib.extend({mapping:{collapse:'caret-square-o-down',expand:'caret-square-o-right',delete:'times',edit:'pencil',add:'plus',cancel:'ban',save:'save',moveup:'arrow-up',movedown:'arrow-down'},icon_prefix:'fa fa-'}),d.defaults.iconlibs.foundation2=d.AbstractIconLib.extend({mapping:{collapse:'minus',expand:'plus',delete:'remove',edit:'edit',add:'add-doc',cancel:'error',save:'checkmark',moveup:'up-arrow',movedown:'down-arrow'},icon_prefix:'foundicon-'}),d.defaults.iconlibs.foundation3=d.AbstractIconLib.extend({mapping:{collapse:'minus',expand:'plus',delete:'x',edit:'pencil',add:'page-add',cancel:'x-circle',save:'save',moveup:'arrow-up',movedown:'arrow-down'},icon_prefix:'fi-'}),d.defaults.iconlibs.jqueryui=d.AbstractIconLib.extend({mapping:{collapse:'triangle-1-s',expand:'triangle-1-e',delete:'trash',edit:'pencil',add:'plusthick',cancel:'closethick',save:'disk',moveup:'arrowthick-1-n',movedown:'arrowthick-1-s'},icon_prefix:'ui-icon ui-icon-'}),d.defaults.templates['default']=function(){return{compile:function(e){var t=e.match(/{{\s*([a-zA-Z0-9\-_ \.]+)\s*}}/g),o=t&&t.length;if(!o)return function(){return e};for(var a=[],r=function(e){var o,r=t[e].replace(/[{}]+/g,'').trim().split('.'),i=r.length;if(1<i){var n;o=function(t){for(n=t,e=0;e<i&&(n=n[r[e]],!!n);e++);return n}}else r=r[0],o=function(e){return e[r]};a.push({s:t[e],r:o})},n=0;n<o;n++)r(n);return function(t){var i,r=e+'';for(n=0;n<o;n++)i=a[n],r=r.replace(i.s,i.r(t));return r}}}},d.defaults.templates.ejs=function(){return!!window.EJS&&{compile:function(e){var t=new window.EJS({text:e});return function(e){return t.render(e)}}}},d.defaults.templates.handlebars=function(){return window.Handlebars},d.defaults.templates.hogan=function(){return!!window.Hogan&&{compile:function(e){var t=window.Hogan.compile(e);return function(e){return t.render(e)}}}},d.defaults.templates.markup=function(){return window.Mark&&window.Mark.up&&{compile:function(e){return function(t){return window.Mark.up(e,t)}}}},d.defaults.templates.mustache=function(){return!!window.Mustache&&{compile:function(e){return function(t){return window.Mustache.render(e,t)}}}},d.defaults.templates.swig=function(){return window.swig},d.defaults.templates.underscore=function(){return!!window._&&{compile:function(e){return function(t){return window._.template(e,t)}}}},d.defaults.theme='html',d.defaults.template='default',d.defaults.options={},d.defaults.translate=function(e,t){var o=d.defaults.languages[d.defaults.language];if(!o)throw'Unknown language '+d.defaults.language;var r=o[e]||d.defaults.languages[d.defaults.default_language][e];if('undefined'==typeof r)throw'Unknown translate string '+e;if(t)for(var n=0;n<t.length;n++)r=r.replace(new RegExp('\\{\\{'+n+'}}','g'),t[n]);return r},d.defaults.default_language='en',d.defaults.language=d.defaults.default_language,d.defaults.languages.en={error_notset:'Property must be set',error_notempty:'Value required',error_enum:'Value must be one of the enumerated values',error_anyOf:'Value must validate against at least one of the provided schemas',error_oneOf:'Value must validate against exactly one of the provided schemas. It currently validates against {{0}} of the schemas.',error_not:'Value must not validate against the provided schema',error_type_union:'Value must be one of the provided types',error_type:'Value must be of type {{0}}',error_disallow_union:'Value must not be one of the provided disallowed types',error_disallow:'Value must not be of type {{0}}',error_multipleOf:'Value must be a multiple of {{0}}',error_maximum_excl:'Value must be less than {{0}}',error_maximum_incl:'Value must be at most {{0}}',error_minimum_excl:'Value must be greater than {{0}}',error_minimum_incl:'Value must be at least {{0}}',error_maxLength:'Value must be at most {{0}} characters long',error_minLength:'Value must be at least {{0}} characters long',error_pattern:'Value must match the pattern {{0}}',error_additionalItems:'No additional items allowed in this array',error_maxItems:'Value must have at most {{0}} items',error_minItems:'Value must have at least {{0}} items',error_uniqueItems:'Array must have unique items',error_maxProperties:'Object must have at most {{0}} properties',error_minProperties:'Object must have at least {{0}} properties',error_required:'Object is missing the required property \'{{0}}\'',error_additional_properties:'No additional properties allowed, but property {{0}} is set',error_dependency:'Must have property {{0}}',button_delete_all:'All',button_delete_all_title:'Delete All',button_delete_last:'Last {{0}}',button_delete_last_title:'Delete Last {{0}}',button_add_row_title:'Add {{0}}',button_move_down_title:'Move down',button_move_up_title:'Move up',button_delete_row_title:'Delete {{0}}',button_delete_row_title_short:'Delete',button_collapse:'Collapse',button_expand:'Expand'},d.plugins={ace:{theme:''},epiceditor:{},sceditor:{},select2:{},selectize:{}},l(d.defaults.editors,function(e,t){d.defaults.editors[e].options=t.options||{}}),d.defaults.resolvers.unshift(function(e){if('string'!=typeof e.type)return'multiple'}),d.defaults.resolvers.unshift(function(e){if(!e.type&&e.properties)return'object'}),d.defaults.resolvers.unshift(function(e){if('string'==typeof e.type)return e.type}),d.defaults.resolvers.unshift(function(e){if('boolean'===e.type)return'checkbox'===e.format||e.options&&e.options.checkbox?'checkbox':d.plugins.selectize.enable?'selectize':'select'}),d.defaults.resolvers.unshift(function(e){if('any'===e.type)return'multiple'}),d.defaults.resolvers.unshift(function(e){if('string'===e.type&&e.media&&'base64'===e.media.binaryEncoding)return'base64'}),d.defaults.resolvers.unshift(function(e){if('string'===e.type&&'url'===e.format&&e.options&&!0===e.options.upload&&window.FileReader)return'upload'}),d.defaults.resolvers.unshift(function(e){if('array'==e.type&&'table'==e.format)return'table'}),d.defaults.resolvers.unshift(function(e){if(e.enumSource)return d.plugins.selectize.enable?'selectize':'select'}),d.defaults.resolvers.unshift(function(e){if(e['enum']){if('array'===e.type||'object'===e.type)return'enum';if('number'===e.type||'integer'===e.type||'string'===e.type)return d.plugins.selectize.enable?'selectize':'select'}}),d.defaults.resolvers.unshift(function(e){if('array'===e.type&&e.items&&!Array.isArray(e.items)&&e.uniqueItems&&0<=['string','number','integer'].indexOf(e.items.type)){if(e.items.enum)return'multiselect';if(d.plugins.selectize.enable&&'string'===e.items.type)return'arraySelectize'}}),d.defaults.resolvers.unshift(function(e){if(e.oneOf||e.anyOf)return'multiple'}),function(){if(window.jQuery||window.Zepto){var e=window.jQuery||window.Zepto;e.jsoneditor=d.defaults,e.fn.jsoneditor=function(e){var t=this,o=this.data('jsoneditor');if('value'===e){if(!o)throw'Must initialize jsoneditor before getting/setting the value';if(1<arguments.length)o.setValue(arguments[1]);else return o.getValue()}else{if('validate'===e){if(!o)throw'Must initialize jsoneditor before validating';return 1<arguments.length?o.validate(arguments[1]):o.validate()}'destroy'===e?o&&(o.destroy(),this.data('jsoneditor',null)):(o&&o.destroy(),o=new d(this.get(0),e),this.data('jsoneditor',o),o.on('change',function(){t.trigger('change')}),o.on('ready',function(){t.trigger('ready')}))}return this}}}(),window.JSONEditor=d})(),e.exports=JSONEditor},function(e){e.exports=o},function(e){e.exports=r},function(e){e.exports=i},function(e){e.exports=n},function(e){e.exports=a},function(e){e.exports=s},function(e){e.exports=l},function(e){e.exports=d},function(e){e.exports=p},function(e){e.exports=c},function(e){e.exports=u},function(e){e.exports=m},function(e){e.exports=h},function(e){e.exports=g},function(e){e.exports=y},function(e){e.exports=_},function(e){e.exports=b},function(e){e.exports=f},function(e){e.exports=v},function(e){e.exports=w},function(e){e.exports=x},function(e){e.exports=C},function(e){e.exports=k},function(e){e.exports=E},function(e){e.exports=N},function(e){e.exports=j},function(e){e.exports=T},function(e){e.exports=A},function(e){e.exports=S},function(e){e.exports=I},function(e){e.exports=O},function(e){e.exports=P},function(){},function(e,t,o){function r(e){return o(i(e))}function i(e){var t=n[e];if(!(t+1))throw new Error('Cannot find module \''+e+'\'.');return t}var n={"./lightgray/content.inline.min":4,"./lightgray/content.inline.min.css":4,"./lightgray/content.min":5,"./lightgray/content.min.css":5,"./lightgray/content.mobile.min":6,"./lightgray/content.mobile.min.css":6,"./lightgray/fonts/tinymce":0,"./lightgray/fonts/tinymce-mobile":7,"./lightgray/fonts/tinymce-mobile.woff":7,"./lightgray/fonts/tinymce-small":1,"./lightgray/fonts/tinymce-small.eot":1,"./lightgray/fonts/tinymce-small.svg":52,"./lightgray/fonts/tinymce-small.ttf":53,"./lightgray/fonts/tinymce-small.woff":54,"./lightgray/fonts/tinymce.eot":0,"./lightgray/fonts/tinymce.svg":55,"./lightgray/fonts/tinymce.ttf":56,"./lightgray/fonts/tinymce.woff":57,"./lightgray/img/anchor":8,"./lightgray/img/anchor.gif":8,"./lightgray/img/loader":9,"./lightgray/img/loader.gif":9,"./lightgray/img/object":10,"./lightgray/img/object.gif":10,"./lightgray/img/trans":11,"./lightgray/img/trans.gif":11,"./lightgray/skin.min":12,"./lightgray/skin.min.css":12,"./lightgray/skin.mobile.min":13,"./lightgray/skin.mobile.min.css":13};r.keys=function(){return Object.keys(n)},r.resolve=i,e.exports=r,r.id=51},function(e,t,o){e.exports=o.p+'editorAssets.compiled/skins/lightgray/fonts/tinymce-small.svg'},function(e,t,o){e.exports=o.p+'editorAssets.compiled/skins/lightgray/fonts/tinymce-small.ttf'},function(e,t,o){e.exports=o.p+'editorAssets.compiled/skins/lightgray/fonts/tinymce-small.woff'},function(e,t,o){e.exports=o.p+'editorAssets.compiled/skins/lightgray/fonts/tinymce.svg'},function(e,t,o){e.exports=o.p+'editorAssets.compiled/skins/lightgray/fonts/tinymce.ttf'},function(e,t,o){e.exports=o.p+'editorAssets.compiled/skins/lightgray/fonts/tinymce.woff'}])});